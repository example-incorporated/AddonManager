function ue(e){window.enmity.plugins.registerPlugin(e)}function O(e){return window.enmity.plugins.getPlugin(e)}function B(){return window.enmity.plugins.getPlugins()}const x=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const E=window.enmity.modules.common.Toasts;window.enmity.modules.common.Dialog,window.enmity.modules.common.Token;const p=window.enmity.modules.common.REST;window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const v=window.enmity.modules.common.Navigation,de=window.enmity.modules.common.NavigationNative,G=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const z=window.enmity.modules.common.Linking,y=window.enmity.modules.common.StyleSheet,Y=window.enmity.modules.common.ColorMap;window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux;const _=window.enmity.modules.common.SVG;window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function ge(e){return window.enmity.patcher.create(e)}var K;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(K||(K={}));var T;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(T||(T={}));var J;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(J||(J={}));var W;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(W||(W={}));var X;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(X||(X={}));var q;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(q||(q={}));const{components:a}=window.enmity;a.Alert;const he=a.Button;a.FlatList;const we=a.Image;a.ImageBackground,a.KeyboardAvoidingView,a.Modal,a.Pressable,a.RefreshControl;const R=a.ScrollView;a.SectionList,a.StatusBar,a.StyleSheet,a.Switch;const D=a.Text,fe=a.TextInput;a.TouchableHighlight,a.TouchableOpacity,a.TouchableWithoutFeedback,a.Touchable;const j=a.View;a.VirtualizedList,a.Form,a.FormArrow,a.FormCTA,a.FormCTAButton,a.FormCardSection,a.FormCheckbox,a.FormDivider,a.FormHint,a.FormIcon,a.FormInput,a.FormLabel,a.FormRadio;const r=a.FormRow,S=a.FormSection;a.FormSelect,a.FormSubLabel;const Ee=a.FormSwitch;a.FormTernaryCheckBox,a.FormText,a.FormTextColors,a.FormTextSizes;const Q=G.createStackNavigator(),{ThemeColorMap:M}=Y;var P=({name:e="AddonManager",component:n=j}={})=>{const s=y.createThemedStyleSheet({container:{backgroundColor:M.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:M.BACKGROUND_MOBILE_PRIMARY,color:M.TEXT_NORMAL},header:{backgroundColor:M.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:M.HEADER_PRIMARY},close:{color:M.HEADER_PRIMARY}});return t.createElement(de.NavigationContainer,null,t.createElement(Q.Navigator,{initialRouteName:e,style:s.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:s.cardStyle,headerStyle:s.header,headerTitleContainerStyle:s.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},t.createElement(Q.Screen,{name:e,component:n,options:{headerTitleStyle:{color:"white"},headerLeft:()=>t.createElement(he,{color:s.close.color,title:"Close",onPress:()=>v.pop()}),...G.TransitionPresets.ModalSlideFromBottomIOS}})))};function d(e){return window.enmity.assets.getIDByName(e)}var h="AddonManager",Z="1.0.0",Se="Manage plugins & themes easily!",be=[{name:"mafu",id:"519760564755365888"}],ve="#00ffff",ye={name:h,version:Z,description:Se,authors:be,color:ve};const{ThemeColorMap:ee}=Y;function _e({height:e,width:n,...s}){const l=y.createThemedStyleSheet({icon:{color:ee.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(_.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...l.icon},fill:"currentColor",...s},t.createElement(_.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(_.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function Me({height:e,width:n,...s}){const l=y.createThemedStyleSheet({icon:{color:ee.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(_.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...l.icon},fill:"currentColor",...s},t.createElement(_.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(_.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}function Ie(...e){return window.enmity.modules.getByProps(...e)}function te(...e){return window.enmity.modules.getByName(...e)}window.enmity.modules.common;const xe=d("Small"),C=d("ic_check_24px");function U(e,n,s=()=>{}){window.enmity.plugins.installPlugin(n,l=>{l.name===void 0?E.open({content:`Failed to install ${e}`,source:xe}):(E.open({content:`Successfully installed ${e}!`,source:C}),s())})}function Re(e,n=()=>{}){window.enmity.plugins.uninstallPlugin(e,s=>{E.open({content:`Successfully uninstalled ${e}!`,source:C}),n()})}function H(e,n,s=()=>{}){window.enmity.themer.installTheme(n,l=>{E.open({content:`Successfully installed ${e}!`,source:C}),s()})}function Pe(e,n=()=>{}){window.enmity.themer.uninstallTheme(e,s=>{E.open({content:`Successfully uninstalled ${e}!`,source:C}),n()})}function V(e){return window.enmity.themer.getThemeByName(e)}function L(){return window.enmity.themer.listThemes()}function b(e,n,s){window.enmity.settings.set(e,n,s)}function I(e,n,s){return window.enmity.settings.get(e,n,s)}const Ne="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/plugins.json",$e="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/themes.json",Be="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/plugins_update.txt",pe="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/themes_update.txt";function k(){return JSON.parse(I(h,"plugins","{}").toString())}function A(){return JSON.parse(I(h,"themes","{}").toString())}function ne(){p.get(Ne).then(e=>{b(h,"plugins",e.text)})}function oe(){p.get($e).then(e=>{b(h,"themes",e.text)})}function Ce(){p.get(Be).then(e=>{let n=e.text,s=I(h,"plugins_ver");s?s!=n&&(b(h,"plugins_ver",n),ne()):(b(h,"plugins_ver",n),ne())})}function Le(){p.get(pe).then(e=>{let n=e.text,s=I(h,"themes_ver");s?s!=n&&(b(h,"themes_ver",n),oe()):(b(h,"themes_ver",n),oe())})}const ke=d("ic_download_24px"),Ae=d("ic_trash_24px"),Fe=te("StaticSearchBarContainer");function Oe(){const e=k(),[n,s]=t.useState(""),[l,m]=t.useState(B().map(o=>o.name));return t.createElement(t.Fragment,null,t.createElement(Fe,{placeholder:"Search plugins",onChangeText:o=>s(o)}),t.createElement(R,null,Object.keys(e).sort().filter(o=>o.toLowerCase().includes(n.toLowerCase())).map(o=>t.createElement(r,{label:e[o].version?`${o} - v${e[o].version}`:o,subLabel:e[o].description,leading:l.includes(o)?t.createElement(r.Icon,{source:Ae}):t.createElement(r.Icon,{source:ke}),trailing:r.Arrow,onPress:()=>{l.includes(o)?Re(o,()=>{let u=Object.assign([],l);u.splice(u.indexOf(o),1),m(u)}):U(o,e[o].url,()=>{let u=Object.assign([],l);u.push(o),m(u)})}}))))}const Te=d("ic_download_24px"),De=d("ic_trash_24px"),je=te("StaticSearchBarContainer");function Ue(){const e=A(),[n,s]=t.useState(""),[l,m]=t.useState(L().map(o=>o.name));return t.createElement(t.Fragment,null,t.createElement(je,{placeholder:"Search themes",onChangeText:o=>s(o)}),t.createElement(R,null,Object.keys(e).sort().filter(o=>o.toLowerCase().includes(n.toLowerCase())).map(o=>t.createElement(r,{label:e[o].version?`${o} - v${e[o].version}`:o,subLabel:e[o].description,leading:l.includes(o)?t.createElement(r.Icon,{source:De}):t.createElement(r.Icon,{source:Te}),trailing:r.Arrow,onPress:()=>{l.includes(o)?Pe(o,()=>{let u=Object.assign([],l);u.splice(u.indexOf(o),1),m(u)}):H(o,e[o].url,()=>{let u=Object.assign([],l);u.push(o),m(u)})}}))))}const He=d("ic_download_24px");function Ve(){let e=I(h,"check_updates");if(e===void 0)b(h,"check_updates",!1);else if(e){const n=k(),s=A();let l=ae(n),m=se(s);if(l.length||m.length){let o=l.concat(m).join(", ");E.open({content:`Updates are available for ${o}`,source:He})}}}function re(e,n){return n.localeCompare(e,void 0,{numeric:!0})===1}function ae(e){return B().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&O(n).version&&re(O(n).version,e[n].version))}function se(e){return L().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&V(n).version&&re(V(n).version,e[n].version))}const le=d("ic_download_24px");function Ge(){const e=y.createThemedStyleSheet({container:{flex:1,backgroundColor:x.ThemeColorMap.BACKGROUND_PRIMARY}}),n=k(),s=A(),l=ae(n),m=se(s),[o,u]=t.useState(l.length?l:["@"]),[N,$]=t.useState(m.length?m:["@"]),[i,f]=t.useState(Boolean(I(h,"check_updates")));return t.createElement(R,{style:e.container},t.createElement(S,{title:"UPDATE"},t.createElement(r,{label:"Check updates on startup",trailing:t.createElement(Ee,{value:i,onValueChange:c=>{console.log(c),f(c),b(h,"check_updates",c)}})})),t.createElement(S,{title:"PLUGINS"},o.map(c=>c==="@"?t.createElement(r,{label:"No updates are found for plugins"}):t.createElement(r,{label:c&&`${c} - v${O(c).version} -> v${n[c].version}`,subLabel:n[c].description,leading:t.createElement(r.Icon,{source:le}),trailing:r.Arrow,onPress:()=>{U(c,n[c].url,()=>{let w=Object.assign([],o);w.splice(w.indexOf(c),1),u(w.length?w:["@"])})}}))),t.createElement(S,{title:"THEMES"},N.map(c=>c==="@"?t.createElement(r,{label:"No updates are found for plugins"}):t.createElement(r,{label:c&&`${c} - v${V(c).version} -> v${s[c].version}`,subLabel:s[c].description,leading:t.createElement(r.Icon,{source:le}),trailing:r.Arrow,onPress:()=>{H(c,s[c].url,()=>{let w=Object.assign([],N);w.splice(w.indexOf(c),1),$(w.length?w:["@"])})}}))))}const ze=d("Small"),ie=d("ic_download_24px"),ce=d("ic_check_24px");function Ye(){const e=y.createThemedStyleSheet({container:{flex:1,backgroundColor:x.ThemeColorMap.BACKGROUND_PRIMARY},importText:{color:"white",height:40,paddingLeft:15}}),n=k(),s=A(),[l,m]=t.useState({"":{}}),[o,u]=t.useState({"":{}});function N(i){const f=B().map(g=>g.name),c=L().map(g=>g.name);let w={},F={};i[0].split(";").filter(g=>Object.keys(n).includes(g)).forEach(g=>{w[g]=Object.assign(n[g],{installed:f.includes(g)})}),m(Object.keys(w).length?w:{"":{}}),i[1].split(";").filter(g=>Object.keys(s).includes(g)).forEach(g=>{F[g]=Object.assign(s[g],{installed:c.includes(g)})}),u(Object.keys(F).length?F:{"":{}})}let $;return t.createElement(R,{style:e.container},t.createElement(S,{title:"IMPORT"},t.createElement(fe,{style:e.importText,ref:i=>{$=i},placeholder:"Paste exported text here",onSubmitEditing:i=>{let f=i.nativeEvent.text.split("|");if(f.length!=2){E.open({content:"Invalid text format. Please make sure that you entered correct text.",source:ze});return}N(f)}}),t.createElement(r,{label:"Clear Input",trailing:r.Arrow,onPress:()=>{$.clear(),m({"":{}}),u({"":{}})}})),t.createElement(S,{title:"PLUGINS"},Object.keys(l).map(i=>l[i].url?t.createElement(r,{label:l[i].version?`${i} - v${l[i].version}`:i,subLabel:l[i].description,leading:l[i].installed?t.createElement(r.Icon,{source:ce}):t.createElement(r.Icon,{source:ie}),trailing:l[i].installed?void 0:r.Arrow,onPress:()=>{U(i,n[i].url,()=>{let f=Object.assign({},l);f[i].installed=!0,m(f)})}}):t.createElement(r,{label:"There are no imported plugins yet"}))),t.createElement(S,{title:"THEMES"},Object.keys(o).map(i=>o[i].url?t.createElement(r,{label:o[i].version?`${i} - v${o[i].version}`:i,subLabel:o[i].description,leading:o[i].installed?t.createElement(r.Icon,{source:ce}):t.createElement(r.Icon,{source:ie}),trailing:o[i].installed?void 0:r.Arrow,onPress:()=>{H(i,s[i].url,()=>{let f=Object.assign({},o);f[i].installed=!0,u(f)})}}):t.createElement(r,{label:"There are no imported themes yet"}))))}const Ke=Ie("setString"),Je=d("ic_message_copy"),We=d("img_account_sync_github_white"),Xe=d("img_account_sync_twitter_white"),qe=d("toast_image_saved"),Qe=d("ic_reply_24px"),Ze=d("ic_leave_stage");var me=({settings:e})=>{const n=y.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:x.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:x.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:x.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}});return t.createElement(R,null,t.createElement(j,{style:n.container},t.createElement(we,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:n.image}),t.createElement(j,{style:n.title},t.createElement(D,{style:n.name},"AddonManager"),t.createElement(D,{style:n.author},"by mafu"))),t.createElement(S,{title:"STORE"},t.createElement(r,{label:"Browse plugins",leading:t.createElement(_e,{width:24,height:24}),trailing:r.Arrow,onPress:()=>{v.push(P,{component:Oe,name:"Plugins - AddonManager"})}}),t.createElement(r,{label:"Browse themes",leading:t.createElement(Me,{width:24,height:24}),trailing:r.Arrow,onPress:()=>{v.push(P,{component:Ue,name:"Themes - AddonManager"})}}),t.createElement(r,{label:"Export addons",leading:t.createElement(r.Icon,{source:Qe}),trailing:r.Arrow,onPress:()=>{let s=B().map(m=>m.name).join(";"),l=L().map(m=>m.name).join(";");Ke.setString(`${s}|${l}`),E.open({content:`Copied addon list to clipboard!
Now please save this to somewhere!`,source:Je})}}),t.createElement(r,{label:"Import addons",leading:t.createElement(r.Icon,{source:Ze}),trailing:r.Arrow,onPress:()=>{v.push(P,{component:Ye,name:"Import - AddonManager"})}}),t.createElement(r,{label:"Update addons",leading:t.createElement(r.Icon,{source:qe}),trailing:r.Arrow,onPress:()=>{v.push(P,{component:Ge,name:"Update - AddonManager"})}})),t.createElement(S,{title:"INFORMATION"},t.createElement(r,{label:"Twitter @m4fn3",style:n.info,trailing:r.Arrow,leading:t.createElement(r.Icon,{source:Xe}),onPress:()=>{z.openURL("https://twitter.com/m4fn3")}}),t.createElement(r,{label:"GitHub (m4fn3)",style:n.info,trailing:r.Arrow,leading:t.createElement(r.Icon,{source:We}),onPress:()=>{z.openURL("https://github.com/m4fn3/AddonManager")}})),t.createElement(D,{style:n.footer},`v${Z}`))};const et={id:"addon",name:"addon",displayName:"addon",description:"Open AddonManager",displayDescription:"Open AddonManager",type:T.Chat,execute:async function(e,n){v.push(P,{component:me,name:"AddonManager"})}},tt=ge("AddonManager"),nt={...ye,onStart(){this.commands=[et],Ce(),Le(),Ve()},onStop(){tt.unpatchAll()},getSettingsPanel({settings:e}){return t.createElement(me,{settings:e})}};ue(nt);
