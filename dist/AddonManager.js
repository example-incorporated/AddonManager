function ot(e){window.enmity.plugins.registerPlugin(e)}function O(e){return window.enmity.plugins.getPlugin(e)}function oe(){return window.enmity.plugins.getPlugins()}const g=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const I=window.enmity.modules.common.Toasts,ae=window.enmity.modules.common.Dialog,at=window.enmity.modules.common.Token,D=window.enmity.modules.common.REST;window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const re=window.enmity.modules.common.Navigation,rt=window.enmity.modules.common.NavigationNative,me=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const V=window.enmity.modules.common.Linking,_=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux;const F=window.enmity.modules.common.SVG,it=window.enmity.modules.common.Scenes;window.enmity.modules.common.Moment;function lt(e){return window.enmity.patcher.create(e)}var d="AddonManager",Me="1.1.5",st="Manage plugins & themes easily!",ct=[{name:"mafu",id:"519760564755365888"}],mt="#00ffff",dt={name:d,version:Me,description:st,authors:ct,color:mt};function b(e,n,o){window.enmity.settings.set(e,n,o)}function T(e,n,o){return window.enmity.settings.get(e,n,o)}const U="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/",ut=U+"plugins.json",gt=U+"themes.json",ht=U+"plugins_update.txt",pt=U+"themes_update.txt",Et=U+"compatibility.json";function j(e){return`${e}?${Date.now()}`}function wt(e,n){return`${U}${e}s/${n}.json`}function de(e){try{return JSON.parse(T(d,e,"{}").toString())}catch{return{}}}function K(){return de("plugins")}function z(){return de("themes")}function yt(){return de("compatibility")}function Re(){D.get(j(ut)).then(e=>{b(d,"plugins",e.text)})}function Pe(){D.get(j(gt)).then(e=>{b(d,"themes",e.text)})}function ft(){D.get(j(ht)).then(e=>{let n=e.text,o=T(d,"plugins_ver");o?o!=n&&(b(d,"plugins_ver",n),Re()):(b(d,"plugins_ver",n),Re())})}function bt(){D.get(j(pt)).then(e=>{let n=e.text,o=T(d,"themes_ver");o?o!=n&&(b(d,"themes_ver",n),Pe()):(b(d,"themes_ver",n),Pe())})}function S(e){return window.enmity.assets.getIDByName(e)}const X={byProps:(...e)=>window.enmity.modules.filters.byProps(...e),byName:(e,n)=>window.enmity.modules.filters.byName(e,n),byTypeName:(e,n)=>window.enmity.modules.filters.byTypeName(e,n),byDisplayName:(e,n)=>window.enmity.modules.filters.byDisplayName(e,n)};function vt(...e){return window.enmity.modules.bulk(...e)}function G(...e){return window.enmity.modules.getByProps(...e)}function ue(...e){return window.enmity.modules.getByName(...e)}function St(...e){return window.enmity.modules.getByKeyword(...e)}window.enmity.modules.common;const Tt=ue("Icon"),W=St("getFocusedRoute"),Ne=ue("StaticSearchBarContainer"),Ct=G("acceptInviteAndTransitionToInviteChannel"),_t=G("AppState"),Mt=G("DRMType","FilterType").default,Ie=G("setString"),p={Copy:S("ic_message_copy"),GitHub:S("img_account_sync_github_white"),Twitter:S("img_account_sync_twitter_white"),Discord:S("Discord"),Update:S("toast_image_saved"),Export:S("ic_reply_24px"),Import:S("ic_leave_stage"),Fail:S("Small"),Download:S("ic_download_24px"),Check:S("ic_check_24px"),Clear:S("ic_input_clear_24px"),Uninstall:S("ic_trash_24px"),Settings:S("ic_settings_white_24px"),Add:S("hub-add"),SettingIcon:S("ic_rulebook")},J=_.createThemedStyleSheet({cardStyle:{backgroundColor:g.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:g.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:g.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerText:{color:g.ThemeColorMap.HEADER_PRIMARY}}),Rt={cardStyle:J.cardStyle,headerStyle:J.header,headerTitleContainerStyle:J.headerText,headerTitleStyle:J.headerText,headerBackTitleStyle:J.headerText,headerBackImage:()=>t.createElement(Tt,{source:S("ios-back")}),headerTitleAlign:"center",safeAreaInsets:{top:0}};function Pt(e,n,o,r=186){let s=e.replace("#","");const m=(u,l,w)=>parseInt(u.substring(l[0],l[1]),w),y=m(s,[0,2],16),f=m(s,[2,4],16),i=m(s,[4,6],16);return(y+f+i)/(255*3)>r?o:n}function q(e,n,o=()=>{}){window.enmity.plugins.installPlugin(n,r=>{r.name===void 0?I.open({content:`Failed to install ${e}`,source:p.Fail}):(I.open({content:`Successfully installed ${e}!`,source:p.Check}),o())})}function Ae(e,n=()=>{}){window.enmity.plugins.uninstallPlugin(e,o=>{I.open({content:`Successfully uninstalled ${e}!`,source:p.Check}),n()})}function ie(e,n,o=()=>{}){window.enmity.themer.installTheme(n,r=>{I.open({content:`Successfully installed ${e}!`,source:p.Check}),o()})}function Nt(e,n=()=>{}){window.enmity.themer.uninstallTheme(e,o=>{I.open({content:`Successfully uninstalled ${e}!`,source:p.Check}),n()})}function Y(e){return window.enmity.themer.getThemeByName(e)}function le(){return window.enmity.themer.listThemes()}function It(e){try{let n=Y(window.enmity.themer.getTheme());return n?n.colours[e]:void 0}catch{return}}function se(e,n){let o=ge("plugin");o.push(n),b(d,`_updated_${e}s`,JSON.stringify(o))}function At(e){b(d,`_updated_${e}s`,"[]")}function ge(e){return JSON.parse(T(d,`_updated_${e}s`,"[]").toString())}function kt(){let e=T(d,"check_updates");if(e===void 0)b(d,"check_updates",!1);else if(e){const n=K(),o=z();let r=pe(n),s=Ee(o);if(r.length||s.length){let m=r.concat(s).join(", ");I.open({content:`Updates are available for ${m}`,source:p.Download})}}}function he(e,n){return n.localeCompare(e,void 0,{numeric:!0})}function ke(e,n){return he(e,n)===1}function pe(e){return oe().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&O(n).version&&ke(O(n).version,e[n].version))}function Ee(e){return le().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&Y(n).version&&ke(Y(n).version,e[n].version))}const xt=G("updateNote");async function $t(e){let n=await(await fetch(`https://discord.com/api/v9/users/@me/notes/${e}`,{method:"GET",credentials:"include",headers:{authorization:at.getToken()}})).json();return Object.keys(n).includes("note")?n.note:""}function Dt(e,n){xt.updateNote(e,n)}function xe(){Dt("1048982327809818706",$e())}async function Lt(){return $t("1048982327809818706")}function $e(){let e=oe().map(o=>o.name).join(";"),n=le().map(o=>o.name).join(";");return`${e}|${n}`}V.addEventListener("url",e=>{let n=e.url;n=decodeURIComponent(n.replace("com.hammerandchisel.discord://",""));try{const o=JSON.parse(n);T(d,"auto_backup")&&typeof o.data=="string"&&["installed_theme","overridden_theme","installed_plugin","overridden_plugin"].includes(o.data)&&xe()}catch{return}});const{components:c}=window.enmity;c.Alert;const Bt=c.Button,Ot=c.FlatList,De=c.Image;c.ImageBackground,c.KeyboardAvoidingView,c.Modal,c.Pressable,c.RefreshControl;const L=c.ScrollView;c.SectionList,c.StatusBar,c.StyleSheet,c.Switch;const A=c.Text,Ft=c.TextInput;c.TouchableHighlight;const Le=c.TouchableOpacity;c.TouchableWithoutFeedback,c.Touchable;const we=c.View;c.VirtualizedList,c.Form;const Ut=c.FormArrow;c.FormCTA,c.FormCTAButton,c.FormCardSection,c.FormCheckbox;const jt=c.FormDivider;c.FormHint,c.FormIcon,c.FormInput,c.FormLabel,c.FormRadio;const a=c.FormRow,R=c.FormSection;c.FormSelect,c.FormSubLabel;const ce=c.FormSwitch;c.FormTernaryCheckBox,c.FormText,c.FormTextColors,c.FormTextSizes;function Be({height:e,width:n,...o}){const r=_.createThemedStyleSheet({icon:{color:g.ThemeColorMap.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(F.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...r.icon},fill:"currentColor",...o},t.createElement(F.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(F.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function Oe({height:e,width:n,...o}){const r=_.createThemedStyleSheet({icon:{color:g.ThemeColorMap.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(F.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...r.icon},fill:"currentColor",...o},t.createElement(F.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(F.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}const{native:Z}=window.enmity;function Gt(){Z.reload()}const ye=Z.version;Z.build,Z.device,Z.version;var Fe=({content:e,addonType:n,addonName:o})=>{const r=_.createThemedStyleSheet({hyperLink:{color:g.ThemeColorMap.TEXT_LINK}});return e.replace(/(\bhttps?:\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*)/ig,"<l>$1<l>").split("<l>").map(s=>s.startsWith("http")?t.createElement(A,{style:r.hyperLink,onPress:()=>{let m=n=="plugin"?".js":".json";s.endsWith(m)?n=="plugin"?q(o,s):ie(o,s):V.openURL(s)},onLongPress:()=>{Ie.setString(s),I.open({content:"Copied URL to clipboard",source:p.Copy})}},s):t.createElement(A,null,s))};function H({addonType:e}){let n=It("PRIMARY_DARK_500"),o=n?Pt(n,g.ThemeColorMap.TEXT_NORMAL[0],g.ThemeColorMap.TEXT_NORMAL[1]):g.ThemeColorMap.HEADER_PRIMARY;n=n||g.ThemeColorMap.BACKGROUND_SECONDARY;const r=_.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY,padding:10},previews:{marginTop:20,justifyContent:"center"},addonName:{color:g.ThemeColorMap.TEXT_NORMAL,fontFamily:g.Fonts.PRIMARY_SEMIBOLD,fontSize:20},addonText:{borderBottomWidth:1,borderBottomColor:g.ThemeColorMap.HEADER_PRIMARY,paddingBottom:20},sectionTitle:{marginTop:20,marginLeft:15,color:g.ThemeColorMap.HEADER_PRIMARY},sectionContent:{margin:10,borderRadius:10,borderWidth:1,borderColor:g.ThemeColorMap.HEADER_PRIMARY,color:g.ThemeColorMap.TEXT_NORMAL,padding:10},addonEdit:{backgroundColor:n,paddingTop:10,paddingBottom:10,borderRadius:20,borderWidth:1,width:80,alignItems:"center",borderColor:n,overflow:"hidden"},addonEditText:{color:o,fontFamily:g.Fonts.PRIMARY_SEMIBOLD},hyperLink:{color:g.ThemeColorMap.TEXT_LINK}}),s=_t.useWindowDimensions().width,[m,y]=t.useState("Loading description..."),[f,i]=t.useState([]),u=T(d,`_selected_${e}`).toString(),l=e=="plugin"?K():z(),w=l[u];let x=e=="plugin"?pe(l):Ee(l),k=e=="plugin"?Boolean(O(u)):Boolean(Y(u)),h=x.includes(u);const[E,te]=t.useState(h),[ne,$]=t.useState(k?E?"UPDATE":"REMOVE":"GET"),[_e,nt]=t.useState(void 0);return t.useEffect(()=>{D.get(j(wt(e,u))).then(C=>{let v=JSON.parse(C.text);y(v.description);let P=Object.assign(v.images.map(N=>({url:N,width:1,height:1,type:"image"})),v.videos.map(N=>({url:N,width:null,height:null,type:"video"})));i(P)}).catch(C=>{C.status===404&&y("No description.")});const M=yt();if(u in M[e]){let C=!0;if(M[e][u].ver.includes("~")){let v=M[e][u].ver.split("~"),P=v[0]?v[0]:"0.0",N=v[1]?v[1]:"999.0";he(P,ye)>=0&&he(ye,N)>=0&&(C=!1)}C&&nt(M[e][u].text+`

Compatibility: ${M[e][u].ver} (currently on ${ye})`)}},[]),t.createElement(L,{style:r.container},t.createElement(a,{style:r.addonText,label:()=>t.createElement(A,{style:r.addonName},u),leading:e=="plugin"?t.createElement(Be,{width:32,height:32}):t.createElement(Oe,{width:32,height:32}),trailing:t.createElement(Le,{style:r.addonEdit,onPress:()=>{e=="plugin"?O(u)&&!E?Ae(u,()=>$("GET")):q(u,w.url,()=>{te(!1),se(e,u),$("REMOVE")}):Y(u)&&!E?Nt(u,()=>$("GET")):ie(u,w.url,()=>{te(!1),se(e,u),$("REMOVE")})}},t.createElement(A,{style:r.addonEditText},ne)),subLabel:w.description}),[1].filter(M=>Boolean(_e)).map(M=>t.createElement(t.Fragment,null,t.createElement(A,{style:[r.sectionTitle,{color:"#e74c3c",fontFamily:g.Fonts.PRIMARY_SEMIBOLD}]},"Notice"),t.createElement(A,{style:[r.sectionContent,{borderColor:"#e74c3c"}]},t.createElement(Fe,{content:_e,addonType:e,addonName:u})))),t.createElement(Ot,{horizontal:!0,data:f,style:r.previews,renderItem:({index:M,item:C})=>{if(C.type=="image")return t.createElement(De,{style:{width:C.width,height:C.height,margin:5},source:{uri:C.url},onLoad:({nativeEvent:{source:{width:v,height:P}}})=>{let N=v/P;v=N<1?s*2/5:s*2/3,P=v/N;let B=Object.assign([],f);B[M].width=v,B[M].height=P,i(B)}});if(C.type=="video")return t.createElement(Mt,{style:{width:C.width,height:C.height},source:{uri:C.url},controls:!0,paused:!0,onLoad:({naturalSize:{width:v,height:P}})=>{let N=v/P;v=N<1?s*2/5:s*2/3,P=v/N;let B=Object.assign([],f);B[M].width=v,B[M].height=P,i(B)}})},showsHorizontalScrollIndicator:!0}),t.createElement(A,{style:r.sectionTitle},"Description"),t.createElement(A,{style:r.sectionContent},t.createElement(Fe,{content:m,addonType:e,addonName:u})))}function Ue({isSetting:e=!1}){const n=_.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),o=W.useNavigation(),r=K(),[s,m]=t.useState(""),[y,f]=t.useState(oe().map(i=>i.name));return t.createElement(t.Fragment,null,t.createElement(Ne,{placeholder:"Search plugins",onChangeText:i=>m(i)}),t.createElement(L,{style:n.container},Object.keys(r).sort().filter(i=>i.toLowerCase().includes(s.toLowerCase())).map(i=>t.createElement(a,{label:r[i].version?`${i} - v${r[i].version}`:i,subLabel:r[i].description,leading:y.includes(i)?t.createElement(a.Icon,{source:p.Uninstall}):t.createElement(a.Icon,{source:p.Download}),trailing:a.Arrow,onPress:()=>{b(d,"_selected_plugin",i),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(H,{addonType:"plugin"})}):o.navigate("PluginDetail")},onLongPress:()=>{y.includes(i)?Ae(i,()=>{let u=Object.assign([],y);u.splice(u.indexOf(i),1),f(u)}):q(i,r[i].url,()=>{let u=Object.assign([],y);u.push(i),f(u)})}}))))}function je({isSetting:e=!1}){const n=_.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),o=W.useNavigation(),r=z(),[s,m]=t.useState(""),[y,f]=t.useState(le().map(i=>i.name));return t.createElement(t.Fragment,null,t.createElement(Ne,{placeholder:"Search themes",onChangeText:i=>m(i)}),t.createElement(L,{style:n.container},Object.keys(r).sort().filter(i=>i.toLowerCase().includes(s.toLowerCase())).map(i=>t.createElement(a,{label:r[i].version?`${i} - v${r[i].version}`:i,subLabel:r[i].description,leading:y.includes(i)?t.createElement(a.Icon,{source:p.Uninstall}):t.createElement(a.Icon,{source:p.Download}),trailing:a.Arrow,onPress:()=>{b(d,"_selected_theme",i),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(H,{addonType:"theme"})}):o.navigate("ThemeDetail")}}))))}function Ge({isSetting:e=!1}){const n=_.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),o=W.useNavigation(),r=W.useIsFocused(),s=K(),m=z(),y=pe(s),f=Ee(m);let[i,u]=t.useState(y.length?y:["@"]),[l,w]=t.useState(f.length?f:["@"]);const[x,k]=t.useState(Boolean(T(d,"check_updates",!0)));return t.useEffect(()=>{let h=ge("plugin"),E=Object.assign([],i.filter($=>!h.includes($)));u(E.length?E:["@"]);let te=ge("theme"),ne=Object.assign([],l.filter($=>!te.includes($)));w(ne.length?ne:["@"])},[r]),t.createElement(L,{style:n.container},t.createElement(R,{title:"UPDATE"},t.createElement(a,{label:"Check updates on startup",leading:t.createElement(a.Icon,{source:p.Update}),trailing:t.createElement(ce,{value:x,onValueChange:h=>{k(h),b(d,"check_updates",h)}})})),t.createElement(R,{title:"PLUGINS"},i.map(h=>h==="@"?t.createElement(a,{label:"No updates are found for plugins"}):t.createElement(a,{label:h&&`${h} - v${O(h).version} -> v${s[h].version}`,subLabel:s[h].description,leading:t.createElement(a.Icon,{source:p.Download}),trailing:a.Arrow,onPress:()=>{b(d,"_selected_plugin",h),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(H,{addonType:"plugin"})}):o.navigate("PluginDetail")},onLongPress:()=>{q(h,s[h].url,()=>{se("plugin",h);let E=Object.assign([],i);E.splice(E.indexOf(h),1),u(E.length?E:["@"])})}}))),t.createElement(R,{title:"THEMES"},l.map(h=>h==="@"?t.createElement(a,{label:"No updates are found for themes"}):t.createElement(a,{label:h&&`${h} - v${Y(h).version} -> v${m[h].version}`,subLabel:m[h].description,leading:t.createElement(a.Icon,{source:p.Download}),trailing:a.Arrow,onPress:()=>{b(d,"_selected_theme",h),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(H,{addonType:"theme"})}):o.navigate("ThemeDetail")},onLongPress:()=>{ie(h,m[h].url,()=>{se("theme",h);let E=Object.assign([],l);E.splice(E.indexOf(h),1),w(E.length?E:["@"])})}}))))}function Ye(){const e=_.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY},importText:{color:"white",height:40,paddingLeft:15}}),n=K(),o=z(),[r,s]=t.useState({"":{}}),[m,y]=t.useState({"":{}});function f(l){const w=oe().map(E=>E.name),x=le().map(E=>E.name);let k={},h={};l[0].split(";").filter(E=>Object.keys(n).includes(E)).forEach(E=>{k[E]=Object.assign(n[E],{installed:w.includes(E)})}),s(Object.keys(k).length?k:{"":{}}),l[1].split(";").filter(E=>Object.keys(o).includes(E)).forEach(E=>{h[E]=Object.assign(o[E],{installed:x.includes(E)})}),y(Object.keys(h).length?h:{"":{}})}function i(l,w=void 0){let x=l.split("|");if(x.length!=2){let k=w||"Invalid text format. Please make sure that you entered correct text.";return I.open({content:k,source:p.Fail}),!1}else return x}let u;return t.createElement(L,{style:e.container},t.createElement(R,{title:"IMPORT"},t.createElement(a,{style:e.importBackup,label:"Import from backup",subLabel:"Import installed addons from backup that linked to your discord account.",leading:t.createElement(a.Icon,{source:p.Import}),trailing:a.Arrow,onPress:()=>{Lt().then(l=>{let w=i(l,"No backup was found.");w&&(f(w),I.open({content:"Successfully imported addons from backup!",source:p.Check}))})}})),t.createElement(R,null,t.createElement(Ft,{style:e.importText,ref:l=>{u=l},placeholder:"Paste exported text",onSubmitEditing:l=>{let w=i(l.nativeEvent.text);w&&f(w)}}),t.createElement(a,{label:"Clear Input",trailing:a.Arrow,onPress:()=>{u.clear(),s({"":{}}),y({"":{}})}})),t.createElement(R,{title:"PLUGINS"},Object.keys(r).map(l=>r[l].url?t.createElement(a,{label:r[l].version?`${l} - v${r[l].version}`:l,subLabel:r[l].description,leading:r[l].installed?t.createElement(a.Icon,{source:p.Check}):t.createElement(a.Icon,{source:p.Download}),trailing:r[l].installed?void 0:a.Arrow,onPress:()=>{q(l,n[l].url,()=>{let w=Object.assign({},r);w[l].installed=!0,s(w)})}}):t.createElement(a,{label:"There are no imported plugins yet"}))),t.createElement(R,{title:"THEMES"},Object.keys(m).map(l=>m[l].url?t.createElement(a,{label:m[l].version?`${l} - v${m[l].version}`:l,subLabel:m[l].description,leading:m[l].installed?t.createElement(a.Icon,{source:p.Check}):t.createElement(a.Icon,{source:p.Download}),trailing:m[l].installed?void 0:a.Arrow,onPress:()=>{ie(l,o[l].url,()=>{let w=Object.assign({},m);w[l].installed=!0,y(w)})}}):t.createElement(a,{label:"There are no imported themes yet"}))))}function He(){const e=_.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),[n,o]=t.useState(Boolean(T(d,"auto_backup")));return t.createElement(L,{style:e.container},t.createElement(R,{title:"EXPORT"},t.createElement(a,{label:"Automatically create backup",subLabel:"Automatically save backup of installed addons. It will be linked with your discord account.",leading:t.createElement(a.Icon,{source:p.Export}),trailing:t.createElement(ce,{value:n,onValueChange:r=>{o(r),r&&xe(),b(d,"auto_backup",r)}})})),t.createElement(R,{title:"ADVANCED"},t.createElement(a,{label:"Export addons as text",subLabel:"Export installed addons as text that you can import manually.",leading:t.createElement(a.Icon,{source:p.Copy}),trailing:a.Arrow,onPress:()=>{Ie.setString($e()),I.open({content:"Copied addon list to clipboard!",source:p.Copy})}})))}const Yt="https://github.com/m4fn3/AddonManager",Ht="https://raw.githubusercontent.com/m4fn3/AddonManager/master/manifest.json",Vt="https://raw.githubusercontent.com/m4fn3/AddonManager/master/dist/AddonManager.js",Kt="https://raw.githubusercontent.com/m4fn3/AddonManager/master/changelogs.json";function Ve(e,n){window.enmity.plugins.installPlugin(Vt,()=>{ae.show({title:"AddonManager",body:`Updated from ${e} to ${n}!
Do you want to reload Discord now?`,confirmText:"Yes",cancelText:"Later",onConfirm:()=>Gt()})})}function Ke(e=!1){D.get(Ht).then(n=>{const o=JSON.parse(n.text),r=O(o.name);o.version.localeCompare(r.version,void 0,{numeric:!0})===1?(e||!e&&T(d,"ignored",null)!=o.version)&&D.get(Kt).then(s=>{const m=JSON.parse(s.text);let y="";m[o.version]&&(y=`

- Changelogs
${m[o.version]}`),ae.show({title:"AddonManager",body:`New version v${o.version} is available!${y}`,confirmText:"Update",cancelText:"Ignore",onConfirm:()=>{b(d,"_updating",!0),Ve(r.version,o.version)},onCancel:()=>b(d,"ignored",o.version)})}):e?ae.show({title:"AddonManager",body:`You are using latest version v${r.version}!`,confirmText:"OK"}):b(d,"ignored",null)}).catch(n=>{n.status===404&&ae.show({title:"AddonManager",body:"Failed to check for updates. Please check GitHub manually.",confirmText:"GitHub",cancelText:"Close",onConfirm:()=>V.openURL(Yt)})})}function ze(){const e=_.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),[n,o]=t.useState(Boolean(T(d,"check_updates_me",!0))),[r,s]=t.useState(Boolean(T(d,"add_to_settings",!0)));return t.createElement(L,{style:e.container},t.createElement(R,{title:"OPTIONS"},t.createElement(a,{label:"Check updates of AddonManager itself on startup",subLabel:"You can also click here to check updates manually",leading:t.createElement(a.Icon,{source:p.Update}),trailing:t.createElement(ce,{value:n,onValueChange:m=>{o(m),b(d,"check_updates_me",m)}}),onPress:()=>{Ke(!0)}}),t.createElement(a,{label:"Add the AddonManager section to settings",leading:t.createElement(a.Icon,{source:p.Add}),trailing:t.createElement(ce,{value:r,onValueChange:m=>{s(m),b(d,"add_to_settings",m)}})})))}const zt=ue("HelpMessage"),Q=me.createStackNavigator();function fe(){return t.createElement(Q.Navigator,{initialRouteName:"Home",headerMode:"screen",screenOptions:{...Rt}},t.createElement(Q.Screen,{name:"Home",component:Xe,options:{headerShown:!1}}),[[Ue,"Plugins"],[je,"Themes"],[He,"Export"],[Ye,"Import"],[Ge,"Update"],[ze,"Settings"]].map(([e,n])=>t.createElement(Q.Screen,{name:n,component:e})),t.createElement(Q.Screen,{name:"PluginDetail",component:()=>t.createElement(H,{addonType:"plugin"}),options:{title:""}}),t.createElement(Q.Screen,{name:"ThemeDetail",component:()=>t.createElement(H,{addonType:"theme"}),options:{title:""}}))}function Xe({settings:e}){const n=_.createThemedStyleSheet({container:{backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY},header:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},notice:{marginTop:30,marginLeft:20,marginRight:20},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:g.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:g.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:g.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}}),o=W.useNavigation(),r=T(d,"ignored",null);return t.useEffect(()=>{D.get(j(Et)).then(s=>{b(d,"compatibility",s.text)})},[]),t.createElement(L,{style:n.container},t.createElement(we,{style:n.header},t.createElement(De,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:n.image}),t.createElement(we,{style:n.title},t.createElement(A,{style:n.name},"AddonManager"),t.createElement(A,{style:n.author},"by mafu"))),r?t.createElement(Le,{style:n.notice,onPress:()=>{const s=O(d);Ve(s.version,r)}},t.createElement(zt,{messageType:0},`New version of AddonManager is available. Click here to update to v${r}!`)):t.createElement(t.Fragment,null),t.createElement(R,{title:"STORE"},t.createElement(a,{label:"Browse plugins",leading:t.createElement(Be,{width:24,height:24}),trailing:a.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Plugins",pagePanel:()=>t.createElement(Ue,{isSetting:!0})}):o.navigate("Plugins")}}),t.createElement(a,{label:"Browse themes",leading:t.createElement(Oe,{width:24,height:24}),trailing:a.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Themes",pagePanel:()=>t.createElement(je,{isSetting:!0})}):o.navigate("Themes")}}),t.createElement(a,{label:"Export addons",leading:t.createElement(a.Icon,{source:p.Export}),trailing:a.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Export",pagePanel:He}):o.navigate("Export")}}),t.createElement(a,{label:"Import addons",leading:t.createElement(a.Icon,{source:p.Import}),trailing:a.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Import",pagePanel:Ye}):o.navigate("Import")}}),t.createElement(a,{label:"Update addons",leading:t.createElement(a.Icon,{source:p.Update}),trailing:a.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Update",pagePanel:()=>t.createElement(Ge,{isSetting:!0})}):o.navigate("Update")}}),t.createElement(a,{label:"Settings",leading:t.createElement(a.Icon,{source:p.Settings}),trailing:a.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Settings",pagePanel:()=>t.createElement(ze,{isSetting:!0})}):o.navigate("Settings")}})),t.createElement(R,{title:"INFORMATION"},t.createElement(a,{label:"Follow me on Twitter",style:n.info,trailing:a.Arrow,leading:t.createElement(a.Icon,{source:p.Twitter}),onPress:()=>{V.openURL("https://twitter.com/m4fn3")}}),t.createElement(a,{label:"Visit my server for help",style:n.info,trailing:a.Arrow,leading:t.createElement(a.Icon,{source:p.Discord}),onPress:()=>{Ct.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{o.pop()}})}}),t.createElement(a,{label:"Check Source on GitHub",style:n.info,trailing:a.Arrow,leading:t.createElement(a.Icon,{source:p.GitHub}),onPress:()=>{V.openURL("https://github.com/m4fn3/AddonManager")}})),t.createElement(A,{style:n.footer},`v${Me}`))}var We;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(We||(We={}));var be;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(be||(be={}));var Je;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(Je||(Je={}));var qe;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(qe||(qe={}));var Ze;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(Ze||(Ze={}));var Qe;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(Qe||(Qe={}));const et=me.createStackNavigator();var Xt=({name:e="AddonManager",component:n=we}={})=>{const o=_.createThemedStyleSheet({container:{backgroundColor:g.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:g.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:g.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:g.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerText:{color:g.ThemeColorMap.HEADER_PRIMARY},headerButton:{color:g.ThemeColorMap.HEADER_PRIMARY}});return t.createElement(rt.NavigationContainer,{independent:!0},t.createElement(et.Navigator,{initialRouteName:e,style:o.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:o.cardStyle,headerStyle:o.header,headerTitleAlign:"center",safeAreaInsets:{top:0}}},t.createElement(et.Screen,{name:e,component:n,options:{headerTitleStyle:{color:"white"},headerLeft:()=>t.createElement(Bt,{color:o.headerButton.color,title:"Close",onPress:()=>re.pop()}),...me.TransitionPresets.ModalPresentationIOS}})))};function ve(e,n,o){return window.enmity.utilities.findInReactTree(e,n,o)}const[Wt,Jt,qt,Zt,Qt]=vt(X.byName("MessagesConnected",!1),X.byName("MessagesWrapperConnected",!1),X.byProps("openPrivateChannel"),X.byName("UserSettingsOverviewWrapper",!1),X.byProps("transitionTo")),{Platform:{isPad:Se}}=G("View","Text");let Te=!1;const en=S("ic_information_24px"),tt="643945264868098049";function Ce(){I.open({content:"nvm. It is the normal behaviour on iPad as of now.",source:en}),Te=!0,Qt.transitionTo("/channels/@me",void 0),qt.openPrivateChannel(tt)}const ee=lt("AddonManager"),tn={...dt,onStart(){const e={id:"addon",name:"addon",displayName:"addon",description:"Open AddonManager",displayDescription:"Open AddonManager",type:be.Chat,execute:async function(r,s){Se?Ce():re.push(Xt,{component:fe,name:"AddonManager"})}};this.commands=[e];const n=ee.after(Zt,"default",(r,s,m)=>{const y=ve(m,f=>{var i;return((i=f.type)==null?void 0:i.name)==="UserSettingsOverview"});ee.after(y.type.prototype,"render",({props:{navigation:f}},i,u)=>{const l=ve(u,w=>w.key==="Enmity");!ve(u,w=>w.label==="AddonManager")&&T(d,"add_to_settings",!0)&&l.props.children.push(t.createElement(jt,null),t.createElement(a,{label:"AddonManager",leading:t.createElement(a.Icon,{source:p.SettingIcon}),trailing:t.createElement(Ut,null),onPress:()=>{Se?(re.pop(),Ce()):f.push("AddonManager",{navigation:f})}})),n()})});ee.after(it,"default",(r,s,m)=>({...m,AddonManager:{key:"AddonManager",title:"AddonManager",render:()=>t.createElement(fe,null)}}));const o=Wt||Jt;ee.after(o,"default",(r,s,m)=>{var y,f;if(Te&&((f=(y=s[0].channel)==null?void 0:y.recipients)==null?void 0:f.includes(tt)))return t.createElement(fe,null);Te=!1}),T(d,"check_updates_me",!0)&&(T(d,"_updating",!1)?b(d,"_updating",!1):Ke()),["plugin","theme"].forEach(r=>At(r)),ft(),bt(),kt()},onStop(){ee.unpatchAll()},getSettingsPanel({settings:e}){return Se&&(re.pop(),Ce()),t.createElement(Xe,{settings:e})}};ot(tn);
