function Ke(e){window.enmity.plugins.registerPlugin(e)}function L(e){return window.enmity.plugins.getPlugin(e)}function ee(){return window.enmity.plugins.getPlugins()}const E=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const N=window.enmity.modules.common.Toasts;window.enmity.modules.common.Dialog;const ze=window.enmity.modules.common.Token,O=window.enmity.modules.common.REST;window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const te=window.enmity.modules.common.Navigation,Xe=window.enmity.modules.common.NavigationNative,le=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const ne=window.enmity.modules.common.Linking,I=window.enmity.modules.common.StyleSheet,ye=window.enmity.modules.common.ColorMap;window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux;const F=window.enmity.modules.common.SVG;window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function We(e){return window.enmity.patcher.create(e)}var fe;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(fe||(fe={}));var se;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(se||(se={}));var Se;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(Se||(Se={}));var be;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(be||(be={}));var ve;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(ve||(ve={}));var Te;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(Te||(Te={}));const{components:s}=window.enmity;s.Alert;const Re=s.Button,Je=s.FlatList,Ce=s.Image;s.ImageBackground,s.KeyboardAvoidingView,s.Modal,s.Pressable,s.RefreshControl;const $=s.ScrollView;s.SectionList,s.StatusBar,s.StyleSheet,s.Switch;const M=s.Text,qe=s.TextInput;s.TouchableHighlight;const Ze=s.TouchableOpacity;s.TouchableWithoutFeedback,s.Touchable;const ce=s.View;s.VirtualizedList,s.Form,s.FormArrow,s.FormCTA,s.FormCTAButton,s.FormCardSection,s.FormCheckbox,s.FormDivider,s.FormHint,s.FormIcon,s.FormInput,s.FormLabel,s.FormRadio;const r=s.FormRow,P=s.FormSection;s.FormSelect,s.FormSubLabel;const _e=s.FormSwitch;s.FormTernaryCheckBox,s.FormText,s.FormTextColors,s.FormTextSizes;function v(e,n,o){window.enmity.settings.set(e,n,o)}function x(e,n,o){return window.enmity.settings.get(e,n,o)}var p="AddonManager",Ie="1.1.1",Qe="Manage plugins & themes easily!",et=[{name:"mafu",id:"519760564755365888"}],tt="#00ffff",nt={name:p,version:Ie,description:Qe,authors:et,color:tt};function R(e){return window.enmity.assets.getIDByName(e)}function z(...e){return window.enmity.modules.getByProps(...e)}function Me(...e){return window.enmity.modules.getByName(...e)}function ot(...e){return window.enmity.modules.getByKeyword(...e)}window.enmity.modules.common;const rt=Me("Icon"),X=ot("getFocusedRoute"),Pe=Me("StaticSearchBarContainer"),at=z("acceptInviteAndTransitionToInviteChannel"),it=z("AppState"),lt=z("DRMType","FilterType").default,Ne=z("setString"),g={Copy:R("ic_message_copy"),GitHub:R("img_account_sync_github_white"),Twitter:R("img_account_sync_twitter_white"),Discord:R("Discord"),Update:R("toast_image_saved"),Export:R("ic_reply_24px"),Import:R("ic_leave_stage"),Fail:R("Small"),Download:R("ic_download_24px"),Check:R("ic_check_24px"),Clear:R("ic_input_clear_24px"),Uninstall:R("ic_trash_24px")},W=I.createThemedStyleSheet({cardStyle:{backgroundColor:E.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:E.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:E.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerText:{color:E.ThemeColorMap.HEADER_PRIMARY}}),st={cardStyle:W.cardStyle,headerStyle:W.header,headerTitleContainerStyle:W.headerText,headerTitleStyle:W.headerText,headerBackTitleStyle:W.headerText,headerBackImage:()=>t.createElement(rt,{source:R("ios-back")}),headerTitleAlign:"center",safeAreaInsets:{top:0}};function ct(e,n,o,a=186){let h=e.replace("#","");const d=(c,l,w)=>parseInt(c.substring(l[0],l[1]),w),f=d(h,[0,2],16),T=d(h,[2,4],16),i=d(h,[4,6],16);return(f+T+i)/(255*3)>a?o:n}function U(e,n,o=()=>{}){window.enmity.plugins.installPlugin(n,a=>{a.name===void 0?N.open({content:`Failed to install ${e}`,source:g.Fail}):(N.open({content:`Successfully installed ${e}!`,source:g.Check}),o())})}function me(e,n=()=>{}){window.enmity.plugins.uninstallPlugin(e,o=>{N.open({content:`Successfully uninstalled ${e}!`,source:g.Check}),n()})}function oe(e,n,o=()=>{}){window.enmity.themer.installTheme(n,a=>{N.open({content:`Successfully installed ${e}!`,source:g.Check}),o()})}function mt(e,n=()=>{}){window.enmity.themer.uninstallTheme(e,o=>{N.open({content:`Successfully uninstalled ${e}!`,source:g.Check}),n()})}function j(e){return window.enmity.themer.getThemeByName(e)}function re(){return window.enmity.themer.listThemes()}function dt(e){try{let n=j(window.enmity.themer.getTheme());return n?n.colours[e]:void 0}catch{return}}function ae(e,n){let o=de("plugin");o.push(n),v(p,`_updated_${e}s`,JSON.stringify(o))}function ut(e){v(p,`_updated_${e}s`,"[]")}function de(e){return JSON.parse(x(p,`_updated_${e}s`,"[]").toString())}const G="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/",gt=G+"plugins.json",ht=G+"themes.json",Et=G+"plugins_update.txt",pt=G+"themes_update.txt",wt=G+"compatibility.json";function H(e){return`${e}?${Date.now()}`}function yt(e,n){return`${G}${e}s/${n}.json`}function ue(e){try{return JSON.parse(x(p,e,"{}").toString())}catch{return{}}}function Y(){return ue("plugins")}function J(){return ue("themes")}function ft(){return ue("compatibility")}function xe(){O.get(H(gt)).then(e=>{v(p,"plugins",e.text)})}function Ae(){O.get(H(ht)).then(e=>{v(p,"themes",e.text)})}function St(){O.get(H(Et)).then(e=>{let n=e.text,o=x(p,"plugins_ver");o?o!=n&&(v(p,"plugins_ver",n),xe()):(v(p,"plugins_ver",n),xe())})}function bt(){O.get(H(pt)).then(e=>{let n=e.text,o=x(p,"themes_ver");o?o!=n&&(v(p,"themes_ver",n),Ae()):(v(p,"themes_ver",n),Ae())})}const ke=le.createStackNavigator(),{ThemeColorMap:V}=ye;var vt=({name:e="AddonManager",component:n=ce,detail:o=null}={})=>{const a=I.createThemedStyleSheet({container:{backgroundColor:V.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:V.BACKGROUND_MOBILE_PRIMARY,color:V.TEXT_NORMAL},header:{backgroundColor:V.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerText:{color:V.HEADER_PRIMARY},headerButton:{color:V.HEADER_PRIMARY}});let h,d;return o&&(d=x(d,"_selected_plugin").toString(),h=L(d)),t.createElement(Xe.NavigationContainer,{independent:!0},t.createElement(ke.Navigator,{initialRouteName:e,style:a.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:a.cardStyle,headerStyle:a.header,headerTitleContainerStyle:a.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},t.createElement(ke.Screen,{name:e,component:n,options:{headerTitleStyle:{color:"white"},headerLeft:()=>t.createElement(Re,{color:a.headerButton.color,title:"Close",onPress:()=>te.pop()}),headerRight:()=>o?t.createElement(Re,{color:a.headerButton.color,title:h?"Uninstall":"Install",onPress:()=>{if(h)me(d,()=>te.pop());else{const f=Y();U(d,f[d].url,()=>te.pop())}}}):t.createElement(t.Fragment,null),...le.TransitionPresets.ModalPresentationIOS}})))};const{ThemeColorMap:Be}=ye;function De({height:e,width:n,...o}){const a=I.createThemedStyleSheet({icon:{color:Be.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(F.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...a.icon},fill:"currentColor",...o},t.createElement(F.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(F.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function $e({height:e,width:n,...o}){const a=I.createThemedStyleSheet({icon:{color:Be.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(F.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...a.icon},fill:"currentColor",...o},t.createElement(F.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(F.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}function Tt(){let e=x(p,"check_updates");if(e===void 0)v(p,"check_updates",!1);else if(e){const n=Y(),o=J();let a=he(n),h=Ee(o);if(a.length||h.length){let d=a.concat(h).join(", ");N.open({content:`Updates are available for ${d}`,source:g.Download})}}}function ge(e,n){return n.localeCompare(e,void 0,{numeric:!0})}function Le(e,n){return ge(e,n)===1}function he(e){return ee().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&L(n).version&&Le(L(n).version,e[n].version))}function Ee(e){return re().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&j(n).version&&Le(j(n).version,e[n].version))}const{native:ie}=window.enmity,pe=ie.version;ie.build,ie.device,ie.version;function K({addonType:e}){let n=dt("PRIMARY_DARK_500"),o=n?ct(n,E.ThemeColorMap.TEXT_NORMAL[0],E.ThemeColorMap.TEXT_NORMAL[1]):E.ThemeColorMap.HEADER_PRIMARY;n=n||E.ThemeColorMap.BACKGROUND_SECONDARY;const a=I.createThemedStyleSheet({container:{flex:1,backgroundColor:E.ThemeColorMap.BACKGROUND_PRIMARY,padding:10},previews:{marginTop:20,justifyContent:"center"},addonName:{color:E.ThemeColorMap.TEXT_NORMAL,fontFamily:E.Fonts.PRIMARY_SEMIBOLD,fontSize:20},addonText:{borderBottomWidth:1,borderBottomColor:E.ThemeColorMap.HEADER_PRIMARY,paddingBottom:20},sectionTitle:{marginTop:20,marginLeft:15,color:E.ThemeColorMap.HEADER_PRIMARY},sectionContent:{margin:10,borderRadius:10,borderWidth:1,borderColor:E.ThemeColorMap.HEADER_PRIMARY,color:E.ThemeColorMap.TEXT_NORMAL,padding:10},addonEdit:{backgroundColor:n,paddingTop:10,paddingBottom:10,borderRadius:20,borderWidth:1,width:80,alignItems:"center",borderColor:n,overflow:"hidden"},addonEditText:{color:o,fontFamily:E.Fonts.PRIMARY_SEMIBOLD},hyperLink:{color:E.ThemeColorMap.TEXT_LINK}}),h=it.useWindowDimensions().width,[d,f]=t.useState(["Loading description..."]),[T,i]=t.useState([]),c=x(p,`_selected_${e}`).toString(),l=e=="plugin"?Y():J(),w=l[c];let B=e=="plugin"?he(l):Ee(l),A=e=="plugin"?Boolean(L(c)):Boolean(j(c)),m=B.includes(c);const[u,Z]=t.useState(m),[Q,D]=t.useState(A?u?"UPDATE":"REMOVE":"GET"),[we,Ve]=t.useState(void 0);return t.useEffect(()=>{O.get(H(yt(e,c))).then(b=>{let S=JSON.parse(b.text),C=S.description.replace(/(\bhttps?:\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*)/ig,"<l>$1<l>").split("<l>");f(C);let k=Object.assign(S.images.map(_=>({url:_,width:1,height:1,type:"image"})),S.videos.map(_=>({url:_,width:null,height:null,type:"video"})));i(k)}).catch(b=>{b.status===404&&f(["No description."])});const y=ft();if(c in y[e]){let b=!0;if(y[e][c].ver.includes("~")){let S=y[e][c].ver.split("~"),C=S[0]?S[0]:"0.0",k=S[1]?S[1]:"999.0";ge(C,pe)>=0&&ge(pe,k)>=0&&(b=!1)}b&&Ve(y[e][c].text+`

Compatibility: ${y[e][c].ver} (currently on ${pe})`)}},[]),t.createElement($,{style:a.container},t.createElement(r,{style:a.addonText,label:()=>t.createElement(M,{style:a.addonName},c),leading:e=="plugin"?t.createElement(De,{width:32,height:32}):t.createElement($e,{width:32,height:32}),trailing:t.createElement(Ze,{style:a.addonEdit,onPress:()=>{e=="plugin"?L(c)&&!u?me(c,()=>D("GET")):U(c,w.url,()=>{Z(!1),ae(e,c),D("REMOVE")}):j(c)&&!u?mt(c,()=>D("GET")):oe(c,w.url,()=>{Z(!1),ae(e,c),D("REMOVE")})}},t.createElement(M,{style:a.addonEditText},Q)),subLabel:w.description}),[1].filter(y=>Boolean(we)).map(y=>t.createElement(t.Fragment,null,t.createElement(M,{style:[a.sectionTitle,{color:"#e74c3c",fontFamily:E.Fonts.PRIMARY_SEMIBOLD}]},"Notice"),t.createElement(M,{style:[a.sectionContent,{borderColor:"#e74c3c"}]},we))),t.createElement(Je,{horizontal:!0,data:T,style:a.previews,renderItem:({index:y,item:b})=>{if(b.type=="image")return t.createElement(Ce,{style:{width:b.width,height:b.height,margin:5},source:{uri:b.url},onLoad:({nativeEvent:{source:{width:S,height:C}}})=>{let k=S/C;S=k<1?h*2/5:h*2/3,C=S/k;let _=Object.assign([],T);_[y].width=S,_[y].height=C,i(_)}});if(b.type=="video")return t.createElement(lt,{style:{width:b.width,height:b.height},source:{uri:b.url},controls:!0,paused:!0,onLoad:({naturalSize:{width:S,height:C}})=>{let k=S/C;S=k<1?h*2/5:h*2/3,C=S/k;let _=Object.assign([],T);_[y].width=S,_[y].height=C,i(_)}})},showsHorizontalScrollIndicator:!0}),t.createElement(M,{style:a.sectionTitle},"Description"),t.createElement(M,{style:a.sectionContent},d.map(y=>y.startsWith("http")?t.createElement(M,{style:a.hyperLink,onPress:()=>{let b=e=="plugin"?".js":".json";y.endsWith(b)?e=="plugin"?U(c,y):oe(c,y):ne.openURL(y)},onLongPress:()=>{Ne.setString(y),N.open({content:"Copied URL to clipboard",source:g.Copy})}},y):t.createElement(M,null,y))))}function Oe({isSetting:e=!1}){const n=I.createThemedStyleSheet({container:{flex:1,backgroundColor:E.ThemeColorMap.BACKGROUND_PRIMARY}}),o=X.useNavigation(),a=Y(),[h,d]=t.useState(""),[f,T]=t.useState(ee().map(i=>i.name));return t.createElement(t.Fragment,null,t.createElement(Pe,{placeholder:"Search plugins",onChangeText:i=>d(i)}),t.createElement($,{style:n.container},Object.keys(a).sort().filter(i=>i.toLowerCase().includes(h.toLowerCase())).map(i=>t.createElement(r,{label:a[i].version?`${i} - v${a[i].version}`:i,subLabel:a[i].description,leading:f.includes(i)?t.createElement(r.Icon,{source:g.Uninstall}):t.createElement(r.Icon,{source:g.Download}),trailing:r.Arrow,onPress:()=>{v(p,"_selected_plugin",i),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(K,{addonType:"plugin"})}):o.navigate("PluginDetail")},onLongPress:()=>{f.includes(i)?me(i,()=>{let c=Object.assign([],f);c.splice(c.indexOf(i),1),T(c)}):U(i,a[i].url,()=>{let c=Object.assign([],f);c.push(i),T(c)})}}))))}function Fe({isSetting:e=!1}){const n=I.createThemedStyleSheet({container:{flex:1,backgroundColor:E.ThemeColorMap.BACKGROUND_PRIMARY}}),o=X.useNavigation(),a=J(),[h,d]=t.useState(""),[f,T]=t.useState(re().map(i=>i.name));return t.createElement(t.Fragment,null,t.createElement(Pe,{placeholder:"Search themes",onChangeText:i=>d(i)}),t.createElement($,{style:n.container},Object.keys(a).sort().filter(i=>i.toLowerCase().includes(h.toLowerCase())).map(i=>t.createElement(r,{label:a[i].version?`${i} - v${a[i].version}`:i,subLabel:a[i].description,leading:f.includes(i)?t.createElement(r.Icon,{source:g.Uninstall}):t.createElement(r.Icon,{source:g.Download}),trailing:r.Arrow,onPress:()=>{v(p,"_selected_theme",i),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(K,{addonType:"theme"})}):o.navigate("ThemeDetail")}}))))}function Ue({isSetting:e}){const n=I.createThemedStyleSheet({container:{flex:1,backgroundColor:E.ThemeColorMap.BACKGROUND_PRIMARY}}),o=X.useNavigation(),a=X.useIsFocused(),h=Y(),d=J(),f=he(h),T=Ee(d);let[i,c]=t.useState(f.length?f:["@"]),[l,w]=t.useState(T.length?T:["@"]);const[B,A]=t.useState(Boolean(x(p,"check_updates")));return t.useEffect(()=>{let m=de("plugin"),u=Object.assign([],i.filter(D=>!m.includes(D)));c(u.length?u:["@"]);let Z=de("theme"),Q=Object.assign([],l.filter(D=>!Z.includes(D)));w(Q.length?Q:["@"])},[a]),t.createElement($,{style:n.container},t.createElement(P,{title:"UPDATE"},t.createElement(r,{label:"Check updates on startup",leading:t.createElement(r.Icon,{source:g.Update}),trailing:t.createElement(_e,{value:B,onValueChange:m=>{A(m),v(p,"check_updates",m)}})})),t.createElement(P,{title:"PLUGINS"},i.map(m=>m==="@"?t.createElement(r,{label:"No updates are found for plugins"}):t.createElement(r,{label:m&&`${m} - v${L(m).version} -> v${h[m].version}`,subLabel:h[m].description,leading:t.createElement(r.Icon,{source:g.Download}),trailing:r.Arrow,onPress:()=>{v(p,"_selected_plugin",m),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(K,{addonType:"plugin"})}):o.navigate("PluginDetail")},onLongPress:()=>{U(m,h[m].url,()=>{ae("plugin",m);let u=Object.assign([],i);u.splice(u.indexOf(m),1),c(u.length?u:["@"])})}}))),t.createElement(P,{title:"THEMES"},l.map(m=>m==="@"?t.createElement(r,{label:"No updates are found for themes"}):t.createElement(r,{label:m&&`${m} - v${j(m).version} -> v${d[m].version}`,subLabel:d[m].description,leading:t.createElement(r.Icon,{source:g.Download}),trailing:r.Arrow,onPress:()=>{v(p,"_selected_theme",m),e?o.push("EnmityCustomPage",{Navigation:o,pageName:" ",pagePanel:()=>t.createElement(K,{addonType:"theme"})}):o.navigate("ThemeDetail")},onLongPress:()=>{oe(m,d[m].url,()=>{ae("theme",m);let u=Object.assign([],l);u.splice(u.indexOf(m),1),w(u.length?u:["@"])})}}))))}const Rt=z("updateNote");async function Ct(e){let n=await(await fetch(`https://discord.com/api/v9/users/@me/notes/${e}`,{method:"GET",credentials:"include",headers:{authorization:ze.getToken()}})).json();return Object.keys(n).includes("note")?n.note:""}function _t(e,n){Rt.updateNote(e,n)}function je(){const e=I.createThemedStyleSheet({container:{flex:1,backgroundColor:E.ThemeColorMap.BACKGROUND_PRIMARY},importText:{color:"white",height:40,paddingLeft:15}}),n=Y(),o=J(),[a,h]=t.useState({"":{}}),[d,f]=t.useState({"":{}});function T(l){const w=ee().map(u=>u.name),B=re().map(u=>u.name);let A={},m={};l[0].split(";").filter(u=>Object.keys(n).includes(u)).forEach(u=>{A[u]=Object.assign(n[u],{installed:w.includes(u)})}),h(Object.keys(A).length?A:{"":{}}),l[1].split(";").filter(u=>Object.keys(o).includes(u)).forEach(u=>{m[u]=Object.assign(o[u],{installed:B.includes(u)})}),f(Object.keys(m).length?m:{"":{}})}function i(l,w=void 0){let B=l.split("|");if(B.length!=2){let A=w||"Invalid text format. Please make sure that you entered correct text.";return N.open({content:A,source:g.Fail}),!1}else return B}let c;return t.createElement($,{style:e.container},t.createElement(P,{title:"IMPORT"},t.createElement(r,{style:e.importBackup,label:"Import from backup",subLabel:"Import installed addons from backup that linked to your discord account.",leading:t.createElement(r.Icon,{source:g.Import}),trailing:r.Arrow,onPress:()=>{Ct("1048982327809818706").then(l=>{let w=i(l,"No backup was found.");w&&(T(w),N.open({content:"Successfully imported addons from backup!",source:g.Check}))})}})),t.createElement(P,null,t.createElement(qe,{style:e.importText,ref:l=>{c=l},placeholder:"Paste exported text",onSubmitEditing:l=>{let w=i(l.nativeEvent.text);w&&T(w)}}),t.createElement(r,{label:"Clear Input",trailing:r.Arrow,onPress:()=>{c.clear(),h({"":{}}),f({"":{}})}})),t.createElement(P,{title:"PLUGINS"},Object.keys(a).map(l=>a[l].url?t.createElement(r,{label:a[l].version?`${l} - v${a[l].version}`:l,subLabel:a[l].description,leading:a[l].installed?t.createElement(r.Icon,{source:g.Check}):t.createElement(r.Icon,{source:g.Download}),trailing:a[l].installed?void 0:r.Arrow,onPress:()=>{U(l,n[l].url,()=>{let w=Object.assign({},a);w[l].installed=!0,h(w)})}}):t.createElement(r,{label:"There are no imported plugins yet"}))),t.createElement(P,{title:"THEMES"},Object.keys(d).map(l=>d[l].url?t.createElement(r,{label:d[l].version?`${l} - v${d[l].version}`:l,subLabel:d[l].description,leading:d[l].installed?t.createElement(r.Icon,{source:g.Check}):t.createElement(r.Icon,{source:g.Download}),trailing:d[l].installed?void 0:r.Arrow,onPress:()=>{oe(l,o[l].url,()=>{let w=Object.assign({},d);w[l].installed=!0,f(w)})}}):t.createElement(r,{label:"There are no imported themes yet"}))))}function Ge(){let e=ee().map(o=>o.name).join(";"),n=re().map(o=>o.name).join(";");return`${e}|${n}`}function He(){const e=I.createThemedStyleSheet({container:{flex:1,backgroundColor:E.ThemeColorMap.BACKGROUND_PRIMARY}}),[n,o]=t.useState(Boolean(x(p,"auto_backup")));return t.createElement($,{style:e.container},t.createElement(P,{title:"EXPORT"},t.createElement(r,{label:"Automatically create backup",subLabel:"Automatically save backup of installed addons. It will be linked with your discord account.",leading:t.createElement(r.Icon,{source:g.Export}),trailing:t.createElement(_e,{value:n,onValueChange:a=>{o(a),v(p,"auto_backup",a)}})})),t.createElement(P,{title:"ADVANCED"},t.createElement(r,{label:"Export addons as text",subLabel:"Export installed addons as text that you can import manually.",leading:t.createElement(r.Icon,{source:g.Copy}),trailing:r.Arrow,onPress:()=>{Ne.setString(Ge()),N.open({content:"Copied addon list to clipboard!",source:g.Copy})}})))}const q=le.createStackNavigator();function It(){return t.createElement(q.Navigator,{initialRouteName:"Home",headerMode:"screen",screenOptions:{...st}},t.createElement(q.Screen,{name:"Home",component:Ye,options:{headerShown:!1}}),[[Oe,"Plugins"],[Fe,"Themes"],[He,"Export"],[je,"Import"],[Ue,"Update"]].map(([e,n])=>t.createElement(q.Screen,{name:n,component:e})),t.createElement(q.Screen,{name:"PluginDetail",component:()=>t.createElement(K,{addonType:"plugin"}),options:{title:""}}),t.createElement(q.Screen,{name:"ThemeDetail",component:()=>t.createElement(K,{addonType:"theme"}),options:{title:""}}))}function Ye({settings:e}){const n=I.createThemedStyleSheet({container:{backgroundColor:E.ThemeColorMap.BACKGROUND_PRIMARY},header:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:E.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:E.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:E.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}}),o=X.useNavigation();return t.useEffect(()=>{O.get(H(wt)).then(a=>{v(p,"compatibility",a.text)})},[]),t.createElement($,{style:n.container},t.createElement(ce,{style:n.header},t.createElement(Ce,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:n.image}),t.createElement(ce,{style:n.title},t.createElement(M,{style:n.name},"AddonManager"),t.createElement(M,{style:n.author},"by mafu"))),t.createElement(P,{title:"STORE"},t.createElement(r,{label:"Browse plugins",leading:t.createElement(De,{width:24,height:24}),trailing:r.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Plugins",pagePanel:()=>t.createElement(Oe,{isSetting:!0})}):o.navigate("Plugins")}}),t.createElement(r,{label:"Browse themes",leading:t.createElement($e,{width:24,height:24}),trailing:r.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Themes",pagePanel:()=>t.createElement(Fe,{isSetting:!0})}):o.navigate("Themes")}}),t.createElement(r,{label:"Export addons",leading:t.createElement(r.Icon,{source:g.Export}),trailing:r.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Export",pagePanel:He}):o.navigate("Export")}}),t.createElement(r,{label:"Import addons",leading:t.createElement(r.Icon,{source:g.Import}),trailing:r.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Import",pagePanel:je}):o.navigate("Import")}}),t.createElement(r,{label:"Update addons",leading:t.createElement(r.Icon,{source:g.Update}),trailing:r.Arrow,onPress:()=>{e?o.push("EnmityCustomPage",{Navigation:o,pageName:"Update",pagePanel:()=>t.createElement(Ue,{isSetting:!0})}):o.navigate("Update")}})),t.createElement(P,{title:"INFORMATION"},t.createElement(r,{label:"Follow me on Twitter",style:n.info,trailing:r.Arrow,leading:t.createElement(r.Icon,{source:g.Twitter}),onPress:()=>{ne.openURL("https://twitter.com/m4fn3")}}),t.createElement(r,{label:"Visit my server for help",style:n.info,trailing:r.Arrow,leading:t.createElement(r.Icon,{source:g.Discord}),onPress:()=>{at.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{o.pop()}})}}),t.createElement(r,{label:"Check Source on GitHub",style:n.info,trailing:r.Arrow,leading:t.createElement(r.Icon,{source:g.GitHub}),onPress:()=>{ne.openURL("https://github.com/m4fn3/AddonManager")}})),t.createElement(M,{style:n.footer},`v${Ie}`))}const Mt={id:"addon",name:"addon",displayName:"addon",description:"Open AddonManager",displayDescription:"Open AddonManager",type:se.Chat,execute:async function(e,n){te.push(vt,{component:It,name:"AddonManager"})}};ne.addEventListener("url",e=>{let n=e.url;n=decodeURIComponent(n.replace("com.hammerandchisel.discord://",""));try{const o=JSON.parse(n);x(p,"auto_backup")&&typeof o.data=="string"&&["installed_theme","overridden_theme","installed_plugin","overridden_plugin"].includes(o.data)&&_t("1048982327809818706",Ge())}catch{return}});const Pt=We("AddonManager"),Nt={...nt,onStart(){this.commands=[Mt],["plugin","theme"].forEach(e=>ut(e)),St(),bt(),Tt()},onStop(){Pt.unpatchAll()},getSettingsPanel({settings:e}){return t.createElement(Ye,{settings:e})}};Ke(Nt);
