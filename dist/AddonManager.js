function ze(e){window.enmity.plugins.registerPlugin(e)}function F(e){return window.enmity.plugins.getPlugin(e)}function ee(){return window.enmity.plugins.getPlugins()}const g=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const N=window.enmity.modules.common.Toasts;window.enmity.modules.common.Dialog;const Xe=window.enmity.modules.common.Token,U=window.enmity.modules.common.REST;window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const te=window.enmity.modules.common.Navigation,We=window.enmity.modules.common.NavigationNative,ce=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const ne=window.enmity.modules.common.Linking,I=window.enmity.modules.common.StyleSheet,ye=window.enmity.modules.common.ColorMap;window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux;const j=window.enmity.modules.common.SVG;window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function Je(e){return window.enmity.patcher.create(e)}var fe;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(fe||(fe={}));var se;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(se||(se={}));var Se;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(Se||(Se={}));var be;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(be||(be={}));var ve;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(ve||(ve={}));var Te;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(Te||(Te={}));const{components:s}=window.enmity;s.Alert;const Re=s.Button,qe=s.FlatList,Ce=s.Image;s.ImageBackground,s.KeyboardAvoidingView,s.Modal,s.Pressable,s.RefreshControl;const L=s.ScrollView;s.SectionList,s.StatusBar,s.StyleSheet,s.Switch;const P=s.Text,Ze=s.TextInput;s.TouchableHighlight;const Qe=s.TouchableOpacity;s.TouchableWithoutFeedback,s.Touchable;const de=s.View;s.VirtualizedList,s.Form,s.FormArrow,s.FormCTA,s.FormCTAButton,s.FormCardSection,s.FormCheckbox,s.FormDivider,s.FormHint,s.FormIcon,s.FormInput,s.FormLabel,s.FormRadio;const l=s.FormRow,M=s.FormSection;s.FormSelect,s.FormSubLabel;const _e=s.FormSwitch;s.FormTernaryCheckBox,s.FormText,s.FormTextColors,s.FormTextSizes;function b(e,n,a){window.enmity.settings.set(e,n,a)}function x(e,n,a){return window.enmity.settings.get(e,n,a)}var h="AddonManager",Ie="1.1.2",et="Manage plugins & themes easily!",tt=[{name:"mafu",id:"519760564755365888"}],nt="#00ffff",ot={name:h,version:Ie,description:et,authors:tt,color:nt};function R(e){return window.enmity.assets.getIDByName(e)}function W(...e){return window.enmity.modules.getByProps(...e)}function Pe(...e){return window.enmity.modules.getByName(...e)}function rt(...e){return window.enmity.modules.getByKeyword(...e)}window.enmity.modules.common;const at=Pe("Icon"),J=rt("getFocusedRoute"),Me=Pe("StaticSearchBarContainer"),lt=W("acceptInviteAndTransitionToInviteChannel"),it=W("AppState"),ct=W("DRMType","FilterType").default,Ne=W("setString"),u={Copy:R("ic_message_copy"),GitHub:R("img_account_sync_github_white"),Twitter:R("img_account_sync_twitter_white"),Discord:R("Discord"),Update:R("toast_image_saved"),Export:R("ic_reply_24px"),Import:R("ic_leave_stage"),Fail:R("Small"),Download:R("ic_download_24px"),Check:R("ic_check_24px"),Clear:R("ic_input_clear_24px"),Uninstall:R("ic_trash_24px")},q=I.createThemedStyleSheet({cardStyle:{backgroundColor:g.ThemeColorMap.BACKGROUND_MOBILE_PRIMARY,color:g.ThemeColorMap.TEXT_NORMAL},header:{backgroundColor:g.ThemeColorMap.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerText:{color:g.ThemeColorMap.HEADER_PRIMARY}}),st={cardStyle:q.cardStyle,headerStyle:q.header,headerTitleContainerStyle:q.headerText,headerTitleStyle:q.headerText,headerBackTitleStyle:q.headerText,headerBackImage:()=>t.createElement(at,{source:R("ios-back")}),headerTitleAlign:"center",safeAreaInsets:{top:0}};function dt(e,n,a,o=186){let d=e.replace("#","");const m=(r,i,E)=>parseInt(r.substring(i[0],i[1]),E),w=m(d,[0,2],16),y=m(d,[2,4],16),v=m(d,[4,6],16);return(w+y+v)/(255*3)>o?a:n}function H(e,n,a=()=>{}){window.enmity.plugins.installPlugin(n,o=>{o.name===void 0?N.open({content:`Failed to install ${e}`,source:u.Fail}):(N.open({content:`Successfully installed ${e}!`,source:u.Check}),a())})}function me(e,n=()=>{}){window.enmity.plugins.uninstallPlugin(e,a=>{N.open({content:`Successfully uninstalled ${e}!`,source:u.Check}),n()})}function oe(e,n,a=()=>{}){window.enmity.themer.installTheme(n,o=>{N.open({content:`Successfully installed ${e}!`,source:u.Check}),a()})}function mt(e,n=()=>{}){window.enmity.themer.uninstallTheme(e,a=>{N.open({content:`Successfully uninstalled ${e}!`,source:u.Check}),n()})}function G(e){return window.enmity.themer.getThemeByName(e)}function re(){return window.enmity.themer.listThemes()}function ut(e){try{let n=G(window.enmity.themer.getTheme());return n?n.colours[e]:void 0}catch{return}}function ae(e,n){let a=ue("plugin");a.push(n),b(h,`_updated_${e}s`,JSON.stringify(a))}function gt(e){b(h,`_updated_${e}s`,"[]")}function ue(e){return JSON.parse(x(h,`_updated_${e}s`,"[]").toString())}const Y="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/",ht=Y+"plugins.json",Et=Y+"themes.json",pt=Y+"plugins_update.txt",wt=Y+"themes_update.txt",yt=Y+"compatibility.json";function V(e){return`${e}?${Date.now()}`}function ft(e,n){return`${Y}${e}s/${n}.json`}function ge(e){try{return JSON.parse(x(h,e,"{}").toString())}catch{return{}}}function K(){return ge("plugins")}function Z(){return ge("themes")}function St(){return ge("compatibility")}function xe(){U.get(V(ht)).then(e=>{b(h,"plugins",e.text)})}function Ae(){U.get(V(Et)).then(e=>{b(h,"themes",e.text)})}function bt(){U.get(V(pt)).then(e=>{let n=e.text,a=x(h,"plugins_ver");a?a!=n&&(b(h,"plugins_ver",n),xe()):(b(h,"plugins_ver",n),xe())})}function vt(){U.get(V(wt)).then(e=>{let n=e.text,a=x(h,"themes_ver");a?a!=n&&(b(h,"themes_ver",n),Ae()):(b(h,"themes_ver",n),Ae())})}const ke=ce.createStackNavigator(),{ThemeColorMap:z}=ye;var Tt=({name:e="AddonManager",component:n=de,detail:a=null}={})=>{const o=I.createThemedStyleSheet({container:{backgroundColor:z.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:z.BACKGROUND_MOBILE_PRIMARY,color:z.TEXT_NORMAL},header:{backgroundColor:z.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerText:{color:z.HEADER_PRIMARY},headerButton:{color:z.HEADER_PRIMARY}});let d,m;return a&&(m=x(m,"_selected_plugin").toString(),d=F(m)),t.createElement(We.NavigationContainer,{independent:!0},t.createElement(ke.Navigator,{initialRouteName:e,style:o.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:o.cardStyle,headerStyle:o.header,headerTitleContainerStyle:o.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},t.createElement(ke.Screen,{name:e,component:n,options:{headerTitleStyle:{color:"white"},headerLeft:()=>t.createElement(Re,{color:o.headerButton.color,title:"Close",onPress:()=>te.pop()}),headerRight:()=>a?t.createElement(Re,{color:o.headerButton.color,title:d?"Uninstall":"Install",onPress:()=>{if(d)me(m,()=>te.pop());else{const w=K();H(m,w[m].url,()=>te.pop())}}}):t.createElement(t.Fragment,null),...ce.TransitionPresets.ModalPresentationIOS}})))};const{ThemeColorMap:Be}=ye;function De({height:e,width:n,...a}){const o=I.createThemedStyleSheet({icon:{color:Be.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(j.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...o.icon},fill:"currentColor",...a},t.createElement(j.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(j.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function $e({height:e,width:n,...a}){const o=I.createThemedStyleSheet({icon:{color:Be.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(j.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...o.icon},fill:"currentColor",...a},t.createElement(j.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(j.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}function Rt(){let e=x(h,"check_updates");if(e===void 0)b(h,"check_updates",!1);else if(e){const n=K(),a=Z();let o=Ee(n),d=pe(a);if(o.length||d.length){let m=o.concat(d).join(", ");N.open({content:`Updates are available for ${m}`,source:u.Download})}}}function he(e,n){return n.localeCompare(e,void 0,{numeric:!0})}function Le(e,n){return he(e,n)===1}function Ee(e){return ee().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&F(n).version&&Le(F(n).version,e[n].version))}function pe(e){return re().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&G(n).version&&Le(G(n).version,e[n].version))}const{native:le}=window.enmity,we=le.version;le.build,le.device,le.version;function X({addonType:e}){let n=ut("PRIMARY_DARK_500"),a=n?dt(n,g.ThemeColorMap.TEXT_NORMAL[0],g.ThemeColorMap.TEXT_NORMAL[1]):g.ThemeColorMap.HEADER_PRIMARY;n=n||g.ThemeColorMap.BACKGROUND_SECONDARY;const o=I.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY,padding:10},previews:{marginTop:20,justifyContent:"center"},addonName:{color:g.ThemeColorMap.TEXT_NORMAL,fontFamily:g.Fonts.PRIMARY_SEMIBOLD,fontSize:20},addonText:{borderBottomWidth:1,borderBottomColor:g.ThemeColorMap.HEADER_PRIMARY,paddingBottom:20},sectionTitle:{marginTop:20,marginLeft:15,color:g.ThemeColorMap.HEADER_PRIMARY},sectionContent:{margin:10,borderRadius:10,borderWidth:1,borderColor:g.ThemeColorMap.HEADER_PRIMARY,color:g.ThemeColorMap.TEXT_NORMAL,padding:10},addonEdit:{backgroundColor:n,paddingTop:10,paddingBottom:10,borderRadius:20,borderWidth:1,width:80,alignItems:"center",borderColor:n,overflow:"hidden"},addonEditText:{color:a,fontFamily:g.Fonts.PRIMARY_SEMIBOLD},hyperLink:{color:g.ThemeColorMap.TEXT_LINK}}),d=it.useWindowDimensions().width,[m,w]=t.useState(["Loading description..."]),[y,v]=t.useState([]),r=x(h,`_selected_${e}`).toString(),i=e=="plugin"?K():Z(),E=i[r];let A=e=="plugin"?Ee(i):pe(i),k=e=="plugin"?Boolean(F(r)):Boolean(G(r)),D=A.includes(r);const[c,T]=t.useState(D),[ie,$]=t.useState(k?c?"UPDATE":"REMOVE":"GET"),[O,Ke]=t.useState(void 0);return t.useEffect(()=>{U.get(V(ft(e,r))).then(S=>{let f=JSON.parse(S.text),C=f.description.replace(/(\bhttps?:\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*)/ig,"<l>$1<l>").split("<l>");w(C);let B=Object.assign(f.images.map(_=>({url:_,width:1,height:1,type:"image"})),f.videos.map(_=>({url:_,width:null,height:null,type:"video"})));v(B)}).catch(S=>{S.status===404&&w(["No description."])});const p=St();if(r in p[e]){let S=!0;if(p[e][r].ver.includes("~")){let f=p[e][r].ver.split("~"),C=f[0]?f[0]:"0.0",B=f[1]?f[1]:"999.0";he(C,we)>=0&&he(we,B)>=0&&(S=!1)}S&&Ke(p[e][r].text+`

Compatibility: ${p[e][r].ver} (currently on ${we})`)}},[]),t.createElement(L,{style:o.container},t.createElement(l,{style:o.addonText,label:()=>t.createElement(P,{style:o.addonName},r),leading:e=="plugin"?t.createElement(De,{width:32,height:32}):t.createElement($e,{width:32,height:32}),trailing:t.createElement(Qe,{style:o.addonEdit,onPress:()=>{e=="plugin"?F(r)&&!c?me(r,()=>$("GET")):H(r,E.url,()=>{T(!1),ae(e,r),$("REMOVE")}):G(r)&&!c?mt(r,()=>$("GET")):oe(r,E.url,()=>{T(!1),ae(e,r),$("REMOVE")})}},t.createElement(P,{style:o.addonEditText},ie)),subLabel:E.description}),[1].filter(p=>Boolean(O)).map(p=>t.createElement(t.Fragment,null,t.createElement(P,{style:[o.sectionTitle,{color:"#e74c3c",fontFamily:g.Fonts.PRIMARY_SEMIBOLD}]},"Notice"),t.createElement(P,{style:[o.sectionContent,{borderColor:"#e74c3c"}]},O))),t.createElement(qe,{horizontal:!0,data:y,style:o.previews,renderItem:({index:p,item:S})=>{if(S.type=="image")return t.createElement(Ce,{style:{width:S.width,height:S.height,margin:5},source:{uri:S.url},onLoad:({nativeEvent:{source:{width:f,height:C}}})=>{let B=f/C;f=B<1?d*2/5:d*2/3,C=f/B;let _=Object.assign([],y);_[p].width=f,_[p].height=C,v(_)}});if(S.type=="video")return t.createElement(ct,{style:{width:S.width,height:S.height},source:{uri:S.url},controls:!0,paused:!0,onLoad:({naturalSize:{width:f,height:C}})=>{let B=f/C;f=B<1?d*2/5:d*2/3,C=f/B;let _=Object.assign([],y);_[p].width=f,_[p].height=C,v(_)}})},showsHorizontalScrollIndicator:!0}),t.createElement(P,{style:o.sectionTitle},"Description"),t.createElement(P,{style:o.sectionContent},m.map(p=>p.startsWith("http")?t.createElement(P,{style:o.hyperLink,onPress:()=>{let S=e=="plugin"?".js":".json";p.endsWith(S)?e=="plugin"?H(r,p):oe(r,p):ne.openURL(p)},onLongPress:()=>{Ne.setString(p),N.open({content:"Copied URL to clipboard",source:u.Copy})}},p):t.createElement(P,null,p))))}function Oe({isSetting:e=!1,renderPage:n=null}){const a=I.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),o=J.useNavigation(),d=K(),[m,w]=t.useState(""),[y,v]=t.useState(ee().map(r=>r.name));return t.createElement(t.Fragment,null,t.createElement(Me,{placeholder:"Search plugins",onChangeText:r=>w(r)}),t.createElement(L,{style:a.container},Object.keys(d).sort().filter(r=>r.toLowerCase().includes(m.toLowerCase())).map(r=>t.createElement(l,{label:d[r].version?`${r} - v${d[r].version}`:r,subLabel:d[r].description,leading:y.includes(r)?t.createElement(l.Icon,{source:u.Uninstall}):t.createElement(l.Icon,{source:u.Download}),trailing:l.Arrow,onPress:()=>{b(h,"_selected_plugin",r),e?n(o,{pageName:" ",pagePanel:()=>t.createElement(X,{addonType:"plugin"})}):o.navigate("PluginDetail")},onLongPress:()=>{y.includes(r)?me(r,()=>{let i=Object.assign([],y);i.splice(i.indexOf(r),1),v(i)}):H(r,d[r].url,()=>{let i=Object.assign([],y);i.push(r),v(i)})}}))))}function Fe({isSetting:e=!1,renderPage:n=null}){const a=I.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),o=J.useNavigation(),d=Z(),[m,w]=t.useState(""),[y,v]=t.useState(re().map(r=>r.name));return t.createElement(t.Fragment,null,t.createElement(Me,{placeholder:"Search themes",onChangeText:r=>w(r)}),t.createElement(L,{style:a.container},Object.keys(d).sort().filter(r=>r.toLowerCase().includes(m.toLowerCase())).map(r=>t.createElement(l,{label:d[r].version?`${r} - v${d[r].version}`:r,subLabel:d[r].description,leading:y.includes(r)?t.createElement(l.Icon,{source:u.Uninstall}):t.createElement(l.Icon,{source:u.Download}),trailing:l.Arrow,onPress:()=>{b(h,"_selected_theme",r),e?n(o,{pageName:" ",pagePanel:()=>t.createElement(X,{addonType:"theme"})}):o.navigate("ThemeDetail")}}))))}function Ue({isSetting:e=!1,renderPage:n=null}){const a=I.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),o=J.useNavigation(),d=J.useIsFocused(),m=K(),w=Z(),y=Ee(m),v=pe(w);let[r,i]=t.useState(y.length?y:["@"]),[E,A]=t.useState(v.length?v:["@"]);const[k,D]=t.useState(Boolean(x(h,"check_updates")));return t.useEffect(()=>{let c=ue("plugin"),T=Object.assign([],r.filter(O=>!c.includes(O)));i(T.length?T:["@"]);let ie=ue("theme"),$=Object.assign([],E.filter(O=>!ie.includes(O)));A($.length?$:["@"])},[d]),t.createElement(L,{style:a.container},t.createElement(M,{title:"UPDATE"},t.createElement(l,{label:"Check updates on startup",leading:t.createElement(l.Icon,{source:u.Update}),trailing:t.createElement(_e,{value:k,onValueChange:c=>{D(c),b(h,"check_updates",c)}})})),t.createElement(M,{title:"PLUGINS"},r.map(c=>c==="@"?t.createElement(l,{label:"No updates are found for plugins"}):t.createElement(l,{label:c&&`${c} - v${F(c).version} -> v${m[c].version}`,subLabel:m[c].description,leading:t.createElement(l.Icon,{source:u.Download}),trailing:l.Arrow,onPress:()=>{b(h,"_selected_plugin",c),e?n(o,{pageName:" ",pagePanel:()=>t.createElement(X,{addonType:"plugin"})}):o.navigate("PluginDetail")},onLongPress:()=>{H(c,m[c].url,()=>{ae("plugin",c);let T=Object.assign([],r);T.splice(T.indexOf(c),1),i(T.length?T:["@"])})}}))),t.createElement(M,{title:"THEMES"},E.map(c=>c==="@"?t.createElement(l,{label:"No updates are found for themes"}):t.createElement(l,{label:c&&`${c} - v${G(c).version} -> v${w[c].version}`,subLabel:w[c].description,leading:t.createElement(l.Icon,{source:u.Download}),trailing:l.Arrow,onPress:()=>{b(h,"_selected_theme",c),e?n(o,{pageName:" ",pagePanel:()=>t.createElement(X,{addonType:"theme"})}):o.navigate("ThemeDetail")},onLongPress:()=>{oe(c,w[c].url,()=>{ae("theme",c);let T=Object.assign([],E);T.splice(T.indexOf(c),1),A(T.length?T:["@"])})}}))))}const Ct=W("updateNote");async function _t(e){let n=await(await fetch(`https://discord.com/api/v9/users/@me/notes/${e}`,{method:"GET",credentials:"include",headers:{authorization:Xe.getToken()}})).json();return Object.keys(n).includes("note")?n.note:""}function It(e,n){Ct.updateNote(e,n)}function je(){const e=I.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY},importText:{color:"white",height:40,paddingLeft:15}}),n=K(),a=Z(),[o,d]=t.useState({"":{}}),[m,w]=t.useState({"":{}});function y(i){const E=ee().map(c=>c.name),A=re().map(c=>c.name);let k={},D={};i[0].split(";").filter(c=>Object.keys(n).includes(c)).forEach(c=>{k[c]=Object.assign(n[c],{installed:E.includes(c)})}),d(Object.keys(k).length?k:{"":{}}),i[1].split(";").filter(c=>Object.keys(a).includes(c)).forEach(c=>{D[c]=Object.assign(a[c],{installed:A.includes(c)})}),w(Object.keys(D).length?D:{"":{}})}function v(i,E=void 0){let A=i.split("|");if(A.length!=2){let k=E||"Invalid text format. Please make sure that you entered correct text.";return N.open({content:k,source:u.Fail}),!1}else return A}let r;return t.createElement(L,{style:e.container},t.createElement(M,{title:"IMPORT"},t.createElement(l,{style:e.importBackup,label:"Import from backup",subLabel:"Import installed addons from backup that linked to your discord account.",leading:t.createElement(l.Icon,{source:u.Import}),trailing:l.Arrow,onPress:()=>{_t("1048982327809818706").then(i=>{let E=v(i,"No backup was found.");E&&(y(E),N.open({content:"Successfully imported addons from backup!",source:u.Check}))})}})),t.createElement(M,null,t.createElement(Ze,{style:e.importText,ref:i=>{r=i},placeholder:"Paste exported text",onSubmitEditing:i=>{let E=v(i.nativeEvent.text);E&&y(E)}}),t.createElement(l,{label:"Clear Input",trailing:l.Arrow,onPress:()=>{r.clear(),d({"":{}}),w({"":{}})}})),t.createElement(M,{title:"PLUGINS"},Object.keys(o).map(i=>o[i].url?t.createElement(l,{label:o[i].version?`${i} - v${o[i].version}`:i,subLabel:o[i].description,leading:o[i].installed?t.createElement(l.Icon,{source:u.Check}):t.createElement(l.Icon,{source:u.Download}),trailing:o[i].installed?void 0:l.Arrow,onPress:()=>{H(i,n[i].url,()=>{let E=Object.assign({},o);E[i].installed=!0,d(E)})}}):t.createElement(l,{label:"There are no imported plugins yet"}))),t.createElement(M,{title:"THEMES"},Object.keys(m).map(i=>m[i].url?t.createElement(l,{label:m[i].version?`${i} - v${m[i].version}`:i,subLabel:m[i].description,leading:m[i].installed?t.createElement(l.Icon,{source:u.Check}):t.createElement(l.Icon,{source:u.Download}),trailing:m[i].installed?void 0:l.Arrow,onPress:()=>{oe(i,a[i].url,()=>{let E=Object.assign({},m);E[i].installed=!0,w(E)})}}):t.createElement(l,{label:"There are no imported themes yet"}))))}function He(){let e=ee().map(a=>a.name).join(";"),n=re().map(a=>a.name).join(";");return`${e}|${n}`}function Ge(){const e=I.createThemedStyleSheet({container:{flex:1,backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY}}),[n,a]=t.useState(Boolean(x(h,"auto_backup")));return t.createElement(L,{style:e.container},t.createElement(M,{title:"EXPORT"},t.createElement(l,{label:"Automatically create backup",subLabel:"Automatically save backup of installed addons. It will be linked with your discord account.",leading:t.createElement(l.Icon,{source:u.Export}),trailing:t.createElement(_e,{value:n,onValueChange:o=>{a(o),b(h,"auto_backup",o)}})})),t.createElement(M,{title:"ADVANCED"},t.createElement(l,{label:"Export addons as text",subLabel:"Export installed addons as text that you can import manually.",leading:t.createElement(l.Icon,{source:u.Copy}),trailing:l.Arrow,onPress:()=>{Ne.setString(He()),N.open({content:"Copied addon list to clipboard!",source:u.Copy})}})))}const Q=ce.createStackNavigator();function Pt(){return t.createElement(Q.Navigator,{initialRouteName:"Home",headerMode:"screen",screenOptions:{...st}},t.createElement(Q.Screen,{name:"Home",component:Ye,options:{headerShown:!1}}),[[Oe,"Plugins"],[Fe,"Themes"],[Ge,"Export"],[je,"Import"],[Ue,"Update"]].map(([e,n])=>t.createElement(Q.Screen,{name:n,component:e})),t.createElement(Q.Screen,{name:"PluginDetail",component:()=>t.createElement(X,{addonType:"plugin"}),options:{title:""}}),t.createElement(Q.Screen,{name:"ThemeDetail",component:()=>t.createElement(X,{addonType:"theme"}),options:{title:""}}))}function Ye({settings:e,renderPage:n}){const a=I.createThemedStyleSheet({container:{backgroundColor:g.ThemeColorMap.BACKGROUND_PRIMARY},header:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:g.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:g.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:g.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}}),o=J.useNavigation();return t.useEffect(()=>{U.get(V(yt)).then(d=>{b(h,"compatibility",d.text)})},[]),t.createElement(L,{style:a.container},t.createElement(de,{style:a.header},t.createElement(Ce,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:a.image}),t.createElement(de,{style:a.title},t.createElement(P,{style:a.name},"AddonManager"),t.createElement(P,{style:a.author},"by mafu"))),t.createElement(M,{title:"STORE"},t.createElement(l,{label:"Browse plugins",leading:t.createElement(De,{width:24,height:24}),trailing:l.Arrow,onPress:()=>{e?n(o,{pageName:"Plugins",pagePanel:()=>t.createElement(Oe,{isSetting:!0,renderPage:n})}):o.navigate("Plugins")}}),t.createElement(l,{label:"Browse themes",leading:t.createElement($e,{width:24,height:24}),trailing:l.Arrow,onPress:()=>{e?n(o,{pageName:"Themes",pagePanel:()=>t.createElement(Fe,{isSetting:!0,renderPage:n})}):o.navigate("Themes")}}),t.createElement(l,{label:"Export addons",leading:t.createElement(l.Icon,{source:u.Export}),trailing:l.Arrow,onPress:()=>{e?n(o,{pageName:"Export",pagePanel:Ge}):o.navigate("Export")}}),t.createElement(l,{label:"Import addons",leading:t.createElement(l.Icon,{source:u.Import}),trailing:l.Arrow,onPress:()=>{e?n(o,{pageName:"Import",pagePanel:je}):o.navigate("Import")}}),t.createElement(l,{label:"Update addons",leading:t.createElement(l.Icon,{source:u.Update}),trailing:l.Arrow,onPress:()=>{e?n(o,{pageName:"Update",pagePanel:()=>t.createElement(Ue,{isSetting:!0,renderPage:n})}):o.navigate("Update")}})),t.createElement(M,{title:"INFORMATION"},t.createElement(l,{label:"Follow me on Twitter",style:a.info,trailing:l.Arrow,leading:t.createElement(l.Icon,{source:u.Twitter}),onPress:()=>{ne.openURL("https://twitter.com/m4fn3")}}),t.createElement(l,{label:"Visit my server for help",style:a.info,trailing:l.Arrow,leading:t.createElement(l.Icon,{source:u.Discord}),onPress:()=>{lt.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{o.pop()}})}}),t.createElement(l,{label:"Check Source on GitHub",style:a.info,trailing:l.Arrow,leading:t.createElement(l.Icon,{source:u.GitHub}),onPress:()=>{ne.openURL("https://github.com/m4fn3/AddonManager")}})),t.createElement(P,{style:a.footer},`v${Ie}`))}const Mt={id:"addon",name:"addon",displayName:"addon",description:"Open AddonManager",displayDescription:"Open AddonManager",type:se.Chat,execute:async function(e,n){te.push(Tt,{component:Pt,name:"AddonManager"})}};ne.addEventListener("url",e=>{let n=e.url;n=decodeURIComponent(n.replace("com.hammerandchisel.discord://",""));try{const a=JSON.parse(n);x(h,"auto_backup")&&typeof a.data=="string"&&["installed_theme","overridden_theme","installed_plugin","overridden_plugin"].includes(a.data)&&It("1048982327809818706",He())}catch{return}});const Nt=Je("AddonManager"),Ve={...ot,onStart(){this.commands=[Mt],["plugin","theme"].forEach(e=>gt(e)),bt(),vt(),Rt()},onStop(){Nt.unpatchAll()},renderPage(e,{pageName:n,pagePanel:a}){var o;return(o=e==null?void 0:e.push)==null?void 0:o.call(e,"EnmityCustomPage",{pageName:n,pagePanel:a})},getSettingsPanel({settings:e}){return t.createElement(Ye,{settings:e,renderPage:Ve.renderPage})}};ze(Ve);
