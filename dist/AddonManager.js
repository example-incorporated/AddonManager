function be(e){window.enmity.plugins.registerPlugin(e)}function j(e){return window.enmity.plugins.getPlugin(e)}function C(){return window.enmity.plugins.getPlugins()}const _=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const f=window.enmity.modules.common.Toasts;window.enmity.modules.common.Dialog;const Se=window.enmity.modules.common.Token,N=window.enmity.modules.common.REST;window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const S=window.enmity.modules.common.Navigation,ve=window.enmity.modules.common.NavigationNative,X=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme;const U=window.enmity.modules.common.Linking,y=window.enmity.modules.common.StyleSheet,W=window.enmity.modules.common.ColorMap;window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux;const p=window.enmity.modules.common.SVG;window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function ye(e){return window.enmity.patcher.create(e)}var Q;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(Q||(Q={}));var V;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(V||(V={}));var Z;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(Z||(Z={}));var ee;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(ee||(ee={}));var te;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(te||(te={}));var ne;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(ne||(ne={}));const{components:a}=window.enmity;a.Alert;const _e=a.Button;a.FlatList;const pe=a.Image;a.ImageBackground,a.KeyboardAvoidingView,a.Modal,a.Pressable,a.RefreshControl;const I=a.ScrollView;a.SectionList,a.StatusBar,a.StyleSheet,a.Switch;const H=a.Text,Ie=a.TextInput;a.TouchableHighlight,a.TouchableOpacity,a.TouchableWithoutFeedback,a.Touchable;const G=a.View;a.VirtualizedList,a.Form,a.FormArrow,a.FormCTA,a.FormCTAButton,a.FormCardSection,a.FormCheckbox,a.FormDivider,a.FormHint,a.FormIcon,a.FormInput,a.FormLabel,a.FormRadio;const o=a.FormRow,E=a.FormSection;a.FormSelect,a.FormSubLabel;const oe=a.FormSwitch;a.FormTernaryCheckBox,a.FormText,a.FormTextColors,a.FormTextSizes;const re=X.createStackNavigator(),{ThemeColorMap:x}=W;var $=({name:e="AddonManager",component:n=G}={})=>{const l=y.createThemedStyleSheet({container:{backgroundColor:x.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:x.BACKGROUND_MOBILE_PRIMARY,color:x.TEXT_NORMAL},header:{backgroundColor:x.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:x.HEADER_PRIMARY},close:{color:x.HEADER_PRIMARY}});return t.createElement(ve.NavigationContainer,null,t.createElement(re.Navigator,{initialRouteName:e,style:l.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:l.cardStyle,headerStyle:l.header,headerTitleContainerStyle:l.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},t.createElement(re.Screen,{name:e,component:n,options:{headerTitleStyle:{color:"white"},headerLeft:()=>t.createElement(_e,{color:l.close.color,title:"Close",onPress:()=>S.pop()}),...X.TransitionPresets.ModalSlideFromBottomIOS}})))};function m(e){return window.enmity.assets.getIDByName(e)}var d="AddonManager",le="1.0.1",xe="Manage plugins & themes easily!",$e=[{name:"mafu",id:"519760564755365888"}],Me="#00ffff",ke={name:d,version:le,description:xe,authors:$e,color:Me};const{ThemeColorMap:ae}=W;function Pe({height:e,width:n,...l}){const c=y.createThemedStyleSheet({icon:{color:ae.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(p.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...c.icon},fill:"currentColor",...l},t.createElement(p.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(p.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function Re({height:e,width:n,...l}){const c=y.createThemedStyleSheet({icon:{color:ae.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return t.createElement(p.Svg,{viewBox:"0 0 24 24",style:{height:e,width:n,...c.icon},fill:"currentColor",...l},t.createElement(p.Path,{d:"M0 0h24v24H0z",fill:"none"}),t.createElement(p.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}function z(...e){return window.enmity.modules.getByProps(...e)}function ie(...e){return window.enmity.modules.getByName(...e)}window.enmity.modules.common;const Ce=m("Small"),B=m("ic_check_24px");function Y(e,n,l=()=>{}){window.enmity.plugins.installPlugin(n,c=>{c.name===void 0?f.open({content:`Failed to install ${e}`,source:Ce}):(f.open({content:`Successfully installed ${e}!`,source:B}),l())})}function Ne(e,n=()=>{}){window.enmity.plugins.uninstallPlugin(e,l=>{f.open({content:`Successfully uninstalled ${e}!`,source:B}),n()})}function K(e,n,l=()=>{}){window.enmity.themer.installTheme(n,c=>{f.open({content:`Successfully installed ${e}!`,source:B}),l()})}function Be(e,n=()=>{}){window.enmity.themer.uninstallTheme(e,l=>{f.open({content:`Successfully uninstalled ${e}!`,source:B}),n()})}function J(e){return window.enmity.themer.getThemeByName(e)}function A(){return window.enmity.themer.listThemes()}function b(e,n,l){window.enmity.settings.set(e,n,l)}function v(e,n,l){return window.enmity.settings.get(e,n,l)}const T="https://raw.githubusercontent.com/m4fn3/AddonManagerDatabase/master/",Ae=T+"plugins.json",Te=T+"themes.json",Le=T+"plugins_update.txt",Oe=T+"themes_update.txt";function L(e){return`${e}?${Date.now()}`}function O(){return JSON.parse(v(d,"plugins","{}").toString())}function D(){return JSON.parse(v(d,"themes","{}").toString())}function se(){N.get(L(Ae)).then(e=>{b(d,"plugins",e.text)})}function ce(){N.get(L(Te)).then(e=>{b(d,"themes",e.text)})}function De(){N.get(L(Le)).then(e=>{let n=e.text,l=v(d,"plugins_ver");l?l!=n&&(b(d,"plugins_ver",n),se()):(b(d,"plugins_ver",n),se())})}function Fe(){N.get(L(Oe)).then(e=>{let n=e.text,l=v(d,"themes_ver");l?l!=n&&(b(d,"themes_ver",n),ce()):(b(d,"themes_ver",n),ce())})}const je=m("ic_download_24px"),Ue=m("ic_trash_24px"),Ve=ie("StaticSearchBarContainer");function He(){const e=O(),[n,l]=t.useState(""),[c,g]=t.useState(C().map(r=>r.name));return t.createElement(t.Fragment,null,t.createElement(Ve,{placeholder:"Search plugins",onChangeText:r=>l(r)}),t.createElement(I,null,Object.keys(e).sort().filter(r=>r.toLowerCase().includes(n.toLowerCase())).map(r=>t.createElement(o,{label:e[r].version?`${r} - v${e[r].version}`:r,subLabel:e[r].description,leading:c.includes(r)?t.createElement(o.Icon,{source:Ue}):t.createElement(o.Icon,{source:je}),trailing:o.Arrow,onPress:()=>{c.includes(r)?Ne(r,()=>{let u=Object.assign([],c);u.splice(u.indexOf(r),1),g(u)}):Y(r,e[r].url,()=>{let u=Object.assign([],c);u.push(r),g(u)})}}))))}const Ge=m("ic_download_24px"),ze=m("ic_trash_24px"),Ye=ie("StaticSearchBarContainer");function Ke(){const e=D(),[n,l]=t.useState(""),[c,g]=t.useState(A().map(r=>r.name));return t.createElement(t.Fragment,null,t.createElement(Ye,{placeholder:"Search themes",onChangeText:r=>l(r)}),t.createElement(I,null,Object.keys(e).sort().filter(r=>r.toLowerCase().includes(n.toLowerCase())).map(r=>t.createElement(o,{label:e[r].version?`${r} - v${e[r].version}`:r,subLabel:e[r].description,leading:c.includes(r)?t.createElement(o.Icon,{source:ze}):t.createElement(o.Icon,{source:Ge}),trailing:o.Arrow,onPress:()=>{c.includes(r)?Be(r,()=>{let u=Object.assign([],c);u.splice(u.indexOf(r),1),g(u)}):K(r,e[r].url,()=>{let u=Object.assign([],c);u.push(r),g(u)})}}))))}const Je=m("ic_download_24px");function qe(){let e=v(d,"check_updates");if(e===void 0)b(d,"check_updates",!1);else if(e){const n=O(),l=D();let c=ue(n),g=de(l);if(c.length||g.length){let r=c.concat(g).join(", ");f.open({content:`Updates are available for ${r}`,source:Je})}}}function me(e,n){return n.localeCompare(e,void 0,{numeric:!0})===1}function ue(e){return C().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&j(n).version&&me(j(n).version,e[n].version))}function de(e){return A().map(n=>n.name).filter(n=>Object.keys(e).includes(n)&&Object.keys(e[n]).includes("version")&&J(n).version&&me(J(n).version,e[n].version))}const ge=m("ic_download_24px"),Xe=m("ic_copy_message_link");function We(){const e=y.createThemedStyleSheet({container:{flex:1,backgroundColor:_.ThemeColorMap.BACKGROUND_PRIMARY}}),n=O(),l=D(),c=ue(n),g=de(l),[r,u]=t.useState(c.length?c:["@"]),[M,P]=t.useState(g.length?g:["@"]),[R,s]=t.useState(Boolean(v(d,"check_updates")));return t.createElement(I,{style:e.container},t.createElement(E,{title:"UPDATE"},t.createElement(o,{label:"Check updates on startup",leading:t.createElement(o.Icon,{source:Xe}),trailing:t.createElement(oe,{value:R,onValueChange:i=>{s(i),b(d,"check_updates",i)}})})),t.createElement(E,{title:"PLUGINS"},r.map(i=>i==="@"?t.createElement(o,{label:"No updates are found for plugins"}):t.createElement(o,{label:i&&`${i} - v${j(i).version} -> v${n[i].version}`,subLabel:n[i].description,leading:t.createElement(o.Icon,{source:ge}),trailing:o.Arrow,onPress:()=>{Y(i,n[i].url,()=>{let w=Object.assign([],r);w.splice(w.indexOf(i),1),u(w.length?w:["@"])})}}))),t.createElement(E,{title:"THEMES"},M.map(i=>i==="@"?t.createElement(o,{label:"No updates are found for plugins"}):t.createElement(o,{label:i&&`${i} - v${J(i).version} -> v${l[i].version}`,subLabel:l[i].description,leading:t.createElement(o.Icon,{source:ge}),trailing:o.Arrow,onPress:()=>{K(i,l[i].url,()=>{let w=Object.assign([],M);w.splice(w.indexOf(i),1),P(w.length?w:["@"])})}}))))}const Qe=z("updateNote");async function Ze(e){let n=await(await fetch(`https://discord.com/api/v9/users/@me/notes/${e}`,{method:"GET",credentials:"include",headers:{authorization:Se.getToken()}})).json();return Object.keys(n).includes("note")?n.note:""}function et(e,n){Qe.updateNote(e,n)}const tt=m("Small"),he=m("ic_download_24px"),q=m("ic_check_24px"),nt=m("ic_leave_stage");m("ic_input_clear_24px");function ot(){const e=y.createThemedStyleSheet({container:{flex:1,backgroundColor:_.ThemeColorMap.BACKGROUND_PRIMARY},importText:{color:"white",height:40,paddingLeft:15}}),n=O(),l=D(),[c,g]=t.useState({"":{}}),[r,u]=t.useState({"":{}});function M(s){const i=C().map(h=>h.name),w=A().map(h=>h.name);let k={},F={};s[0].split(";").filter(h=>Object.keys(n).includes(h)).forEach(h=>{k[h]=Object.assign(n[h],{installed:i.includes(h)})}),g(Object.keys(k).length?k:{"":{}}),s[1].split(";").filter(h=>Object.keys(l).includes(h)).forEach(h=>{F[h]=Object.assign(l[h],{installed:w.includes(h)})}),u(Object.keys(F).length?F:{"":{}})}function P(s,i=void 0){let w=s.split("|");if(w.length!=2){let k=i||"Invalid text format. Please make sure that you entered correct text.";return f.open({content:k,source:tt}),!1}else return w}let R;return t.createElement(I,{style:e.container},t.createElement(E,{title:"IMPORT"},t.createElement(o,{style:e.importBackup,label:"Import from backup",subLabel:"Import installed addons from backup that linked to your discord account.",leading:t.createElement(o.Icon,{source:nt}),trailing:o.Arrow,onPress:()=>{Ze("1048982327809818706").then(s=>{let i=P(s,"No backup was found.");i&&(M(i),f.open({content:"Successfully imported addons from backup!",source:q}))})}})),t.createElement(E,null,t.createElement(Ie,{style:e.importText,ref:s=>{R=s},placeholder:"Paste exported text",onSubmitEditing:s=>{let i=P(s.nativeEvent.text);i&&M(i)}}),t.createElement(o,{label:"Clear Input",trailing:o.Arrow,onPress:()=>{R.clear(),g({"":{}}),u({"":{}})}})),t.createElement(E,{title:"PLUGINS"},Object.keys(c).map(s=>c[s].url?t.createElement(o,{label:c[s].version?`${s} - v${c[s].version}`:s,subLabel:c[s].description,leading:c[s].installed?t.createElement(o.Icon,{source:q}):t.createElement(o.Icon,{source:he}),trailing:c[s].installed?void 0:o.Arrow,onPress:()=>{Y(s,n[s].url,()=>{let i=Object.assign({},c);i[s].installed=!0,g(i)})}}):t.createElement(o,{label:"There are no imported plugins yet"}))),t.createElement(E,{title:"THEMES"},Object.keys(r).map(s=>r[s].url?t.createElement(o,{label:r[s].version?`${s} - v${r[s].version}`:s,subLabel:r[s].description,leading:r[s].installed?t.createElement(o.Icon,{source:q}):t.createElement(o.Icon,{source:he}),trailing:r[s].installed?void 0:o.Arrow,onPress:()=>{K(s,l[s].url,()=>{let i=Object.assign({},r);i[s].installed=!0,u(i)})}}):t.createElement(o,{label:"There are no imported themes yet"}))))}const rt=z("setString"),we=m("ic_message_copy"),lt=m("ic_reply_24px");function Ee(){let e=C().map(l=>l.name).join(";"),n=A().map(l=>l.name).join(";");return`${e}|${n}`}function at(){const e=y.createThemedStyleSheet({container:{flex:1,backgroundColor:_.ThemeColorMap.BACKGROUND_PRIMARY}}),[n,l]=t.useState(Boolean(v(d,"auto_backup")));return t.createElement(I,{style:e.container},t.createElement(E,{title:"EXPORT"},t.createElement(o,{label:"Automatically create backup",subLabel:"Automatically save backup of installed addons. It will be linked with your discord account.",leading:t.createElement(o.Icon,{source:lt}),trailing:t.createElement(oe,{value:n,onValueChange:c=>{l(c),b(d,"auto_backup",c)}})})),t.createElement(E,{title:"ADVANCED"},t.createElement(o,{label:"Export addons as text",subLabel:"Export installed addons as text that you can import manually.",leading:t.createElement(o.Icon,{source:we}),trailing:o.Arrow,onPress:()=>{rt.setString(Ee()),f.open({content:"Copied addon list to clipboard!",source:we})}})))}const it=z("acceptInviteAndTransitionToInviteChannel"),st=m("img_account_sync_github_white"),ct=m("img_account_sync_twitter_white"),mt=m("Discord"),ut=m("toast_image_saved"),dt=m("ic_reply_24px"),gt=m("ic_leave_stage");var fe=({settings:e})=>{const n=y.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:_.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:_.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:_.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}});return t.createElement(I,null,t.createElement(G,{style:n.container},t.createElement(pe,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:n.image}),t.createElement(G,{style:n.title},t.createElement(H,{style:n.name},"AddonManager"),t.createElement(H,{style:n.author},"by mafu"))),t.createElement(E,{title:"STORE"},t.createElement(o,{label:"Browse plugins",leading:t.createElement(Pe,{width:24,height:24}),trailing:o.Arrow,onPress:()=>{S.push($,{component:He,name:"Plugins - AddonManager"})}}),t.createElement(o,{label:"Browse themes",leading:t.createElement(Re,{width:24,height:24}),trailing:o.Arrow,onPress:()=>{S.push($,{component:Ke,name:"Themes - AddonManager"})}}),t.createElement(o,{label:"Export addons",leading:t.createElement(o.Icon,{source:dt}),trailing:o.Arrow,onPress:()=>{S.push($,{component:at,name:"Export - AddonManager"})}}),t.createElement(o,{label:"Import addons",leading:t.createElement(o.Icon,{source:gt}),trailing:o.Arrow,onPress:()=>{S.push($,{component:ot,name:"Import - AddonManager"})}}),t.createElement(o,{label:"Update addons",leading:t.createElement(o.Icon,{source:ut}),trailing:o.Arrow,onPress:()=>{S.push($,{component:We,name:"Update - AddonManager"})}})),t.createElement(E,{title:"INFORMATION"},t.createElement(o,{label:"Follow me on Twitter",style:n.info,trailing:o.Arrow,leading:t.createElement(o.Icon,{source:ct}),onPress:()=>{U.openURL("https://twitter.com/m4fn3")}}),t.createElement(o,{label:"Visit my server for help",style:n.info,trailing:o.Arrow,leading:t.createElement(o.Icon,{source:mt}),onPress:()=>{it.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{S.pop()}})}}),t.createElement(o,{label:"Check Source on GitHub",style:n.info,trailing:o.Arrow,leading:t.createElement(o.Icon,{source:st}),onPress:()=>{U.openURL("https://github.com/m4fn3/AddonManager")}})),t.createElement(H,{style:n.footer},`v${le}`))};const ht={id:"addon",name:"addon",displayName:"addon",description:"Open AddonManager",displayDescription:"Open AddonManager",type:V.Chat,execute:async function(e,n){S.push($,{component:fe,name:"AddonManager"})}};U.addEventListener("url",e=>{let n=e.url;n=decodeURIComponent(n.replace("com.hammerandchisel.discord://",""));try{const l=JSON.parse(n);v(d,"auto_backup")&&typeof l.data=="string"&&["installed_theme","overridden_theme","installed_plugin","overridden_plugin"].includes(l.data)&&et("1048982327809818706",Ee())}catch{return}});const wt=ye("AddonManager"),Et={...ke,onStart(){this.commands=[ht],De(),Fe(),qe()},onStop(){wt.unpatchAll()},getSettingsPanel({settings:e}){return t.createElement(fe,{settings:e})}};be(Et);
